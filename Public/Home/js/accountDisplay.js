/* SVN.committedRevision=1559019 */
var current_site_url=jQuery("#currentSiteUrlPrefix").val();jQuery("#applyButton").click(function(){var a=current_site_url+"/member/bind/needBind.do?callback=?";jQuery.getJSON(a,function(b){if(b.result=="notLogin"){yhdLogin();return false}if(b&&b.result){if(b.result=="alreadyvalidate"){YHD.alert(jQuery("#phoneCheck").html());jQuery("#pop_win_ok_btn").hide();return}else{if(b.result=="needvalidate"){YHD.alert("前台提现需要先绑定手机");jQuery("#pop_win_ok_btn").click(function(){window.location.href=current_site_url+"/member/bind/bind.do"});return}}return}else{YHD.alert("前台提现需要先绑定手机");jQuery("#pop_win_ok_btn").click(function(){window.location.href=current_site_url+"/member/bind/bind.do"});return}})});var deadLine=60;function timeToDeadLine(){if(jQuery("#timeToDeadLine_account").length>=1){if(deadLine!=0){jQuery("#timeToDeadLine_account").html("("+deadLine+"秒后)再次发送");
deadLine--;setTimeout("timeToDeadLine()",1000)}else{jQuery("#timeToDeadLine_account").html("发送验证信息");jQuery("#timeToDeadLine_account").removeClass("disable")}}}function sendPhoneCheckAccount(){var b=jQuery("#timeToDeadLine_account").attr("class");if(b.indexOf("disable")!=-1){return}var a=current_site_url+"/account/sendSMSForAccount.do";jQuery.post(a,null,sendPhoneCheckAccountFinish);deadLine=60;jQuery("#timeToDeadLine_account").addClass("disable");timeToDeadLine()}function sendPhoneCheckAccountFinish(a){if(a.code==-99){yhdLogin();return false}if(a.code==1){jQuery("#send_msg").html("短信发送成功")}else{if(a.code==2){jQuery("#send_msg").html("发送短信次数已满，请24小时后再尝试")}else{if(a.code==3){jQuery("#send_msg").html("您点击的太频繁，请1分钟后再试")}else{if(a.code==4){jQuery("#send_msg").html("系统异常，请稍后再试")}else{if(a.code==9){YHD.alert("前台提现需要先绑定手机");
jQuery("#pop_win_ok_btn").click(function(){window.location.href=current_site_url+"/member/bind/bind.do"})}else{jQuery("#send_msg").html("系统异常，请稍后再试")}}}}}timer2=setInterval("clearInfo()",3000)}function checkPhoneCodeForAccount(){var b=jQuery("#account_code").val();if(b.length<16&&b.length>3){var a=current_site_url+"/account/checkSMSForAccount.do?smsValidateCode="+b;jQuery.post(a,null,checkPhoneCodeForAccountFinish)}else{jQuery("#error_msg").html("请填写正确验证码")}}function clearInfo(){jQuery("#send_msg").html("");clearTimeout(timer2)}var timer2;function checkPhoneCodeForAccountFinish(rs){var a=function(){var content2="";content2+="<div class='tixian_box'>";content2+="<ul>";content2+="<li class='quxian_num'><label>您当前可提现的金额为：</label><ins>￥"+jQuery("#availableAmount").val()+"</ins><a target='_blank' href='"+jQuery("#withdrawRuleUrl").val()+"'>阅读提现规则</a></li>";
content2+="<li><label>请选择收款账户类型：</label>";content2+="<select disabled id='refundType'>";content2+="<option value='0'>银行</option>";content2+="</select>";content2+="<font>*</font>";content2+="</li>";content2+="</ul>";content2+="<ul id='bank'>";content2+="<li><label>需提现金额：</label><input type='text' id='bankCashAmount'><font id='bankCashAmount_font' >*</font></li>";content2+="<li><label>持卡人姓名：</label><input type='text' id='bankOwnerName'><font id='bankOwnerName_font'>*</font></li>";content2+="<li><label>开户地：</label><select name='userInfo.address.provinceID' id = 'userInfo_address_provinceID'>";content2+=" <option value='0'>请选择省</option>";content2+="<option value='1'>上海</option>";content2+="<option value='2'>北京</option>";content2+="<option value='3'>天津</option>";content2+="<option value='4'>河北</option>";
content2+="<option value='5'>江苏</option>";content2+="<option value='6'>浙江</option>";content2+="<option value='7'>重庆</option>";content2+="<option value='8'>内蒙古</option>";content2+="<option value='9'>辽宁</option>";content2+="<option value='10'>吉林</option>";content2+="<option value='11'>黑龙江</option>";content2+="<option value='12'>四川</option>";content2+="<option value='13'>安徽</option>";content2+="<option value='14'>福建</option>";content2+="<option value='15'>江西</option>";content2+="<option value='16'>山东</option>";content2+="<option value='17'>河南</option>";content2+="<option value='18'>湖北</option>";content2+="<option value='19'>湖南</option>";content2+="<option value='20'>广东</option>";content2+="<option value='21'>广西</option>";content2+="<option value='22'>海南</option>";content2+="<option value='23'>贵州</option>";
content2+="<option value='24'>云南</option>";content2+="<option value='25'>西藏</option>";content2+="<option value='26'>陕西</option>";content2+="<option value='27'>甘肃</option>";content2+="<option value='28'>青海</option>";content2+="<option value='29'>新疆</option>";content2+="<option value='30'>宁夏</option>";content2+="<option value='31'>台湾</option>";content2+="<option value='32'>山西</option>";content2+="</select>";content2+="<select name='userInfo.address.cityID' id='userInfo_address_cityID'>";content2+="<option value='0'>请选择市/区</option>";content2+="</select><font id=>*</font><br id='city_br' style='display: none;'><label id='city_label' style='display: none;'>&nbsp;</label><font id='city_font'></font></li>";content2+="<li id='bankName_li'><label>开户行：</label><select name='bankName' id='bankName'>";content2+="<option value='0'>请选择银行</option>";
content2+="<option>中国工商银行</option>";content2+="<option>中国农业银行</option>";content2+="<option>中国银行</option>";content2+="<option>建设银行</option>";content2+="<option>邮政储蓄银行</option>";content2+="<option>交通银行</option>";content2+="<option>招商银行</option>";content2+="<option>上海浦东发展银行</option>";content2+="<option>光大银行</option>";content2+="<option>华夏银行</option>";content2+="<option>中国民生银行</option>";content2+="<option>兴业银行</option>";content2+="<option>中信银行</option>";content2+="<option>广东发展银行</option>";content2+="<option>深圳发展银行</option>";content2+="<option>平安银行</option>";content2+="<option>上海农商行</option>";content2+="<option>上海银行</option>";content2+="<option>广州银行</option>";content2+="<option>宁波银行</option>";content2+="<option>南京银行</option>";content2+="<option>渣打银行</option>";content2+="<option>汇丰银行</option>";content2+="<option>花旗银行</option>";
content2+="</select>";content2+="<font id='bankName_font'>*</font></li>";content2+="<li>";content2+="<label>银行卡号：</label><input type='text' id='bankCardNum'><font id=>*</font><br id='bankCardNum_br' style='display: none;'><label id='bankCardNum_label' style='display: none;'>&nbsp;</label><font id='bankCardNum_font'></font>";content2+="<small><b>注意：</b><p>信用卡将无法做提现使用。</p></small>";content2+="</li>";content2+="</ul>";content2+="<p id='submitRefundButton'><button type='submit' id='submitRefund_checkeDouble' onclick='submitRefund()'>确定</button></p>";content2+="</div>";YHD.alert(content2);jQuery("#pop_win_ok_btn").hide();jQuery("#bankName_li").hide();jQuery(".aptab_center").attr("align","");jQuery("#refundType>option:first").attr("selected","selected");var url="/member/userinfo/address.do?type=";
jQuery("select[name='userInfo.address.provinceID']").empty();jQuery("select[name='userInfo.address.provinceID']").prepend("<option value='0'>请选择省</option>");jQuery("select[name='userInfo.address.cityID']").empty();jQuery("select[name='userInfo.address.cityID']").prepend("<option value='0'>请选择市/区</option>");bandProvince();jQuery("select[name='userInfo.address.provinceID']").change(function(){jQuery("select[name='userInfo.address.cityID']").empty();jQuery("select[name='userInfo.address.cityID']").prepend("<option value='0'>请选择市/区</option>");var provinceId=jQuery("select[name='userInfo.address.provinceID']").find("option:selected").val();bandCity(provinceId)});jQuery("select[name='userInfo.address.cityID']").change(function(){jQuery("#bankName_li").show();jQuery("#bankName>option:first").attr("selected","selected")
});function bandProvince(callback){jQuery("select[name='userInfo.address.provinceID']").empty();jQuery("select[name='userInfo.address.provinceID']").prepend("<option value='0'>请选择省</option>");jQuery.get(url+"province&countryID=1",function(data){jQuery.each(eval(data),function(entryIndex,entry){jQuery("select[name='userInfo.address.provinceID']").append("<option value='"+entry.id+"'>"+entry.cnname+"</option>")})})}function bandCity(provId,callback){if(provId&&(provId==1||provId==2||provId==3||provId==7)){jQuery("#userInfo_address_cityID").hide();jQuery("select[name='userInfo.address.cityID']").empty();jQuery("#bankName_li").show();jQuery("#bankName>option:first").attr("selected","selected")}else{jQuery("#userInfo_address_cityID").show();jQuery("#bankName_li").hide();jQuery("select[name='userInfo.address.cityID']").empty();
jQuery("select[name='userInfo.address.cityID']").prepend("<option value='0'>请选择市/区</option>");jQuery.get(url+"city&provId="+provId,function(data){jQuery.each(eval(data),function(entryIndex,entry){jQuery("select[name='userInfo.address.cityID']").append("<option value='"+entry.id+"'>"+entry.cnname+"</option>")})})}}};if(rs.code==-99){yhdLogin();return false}if(rs.code==1){a();return}else{if(rs.code==2){jQuery("#error_msg").html("验证码已过期")}else{if(rs.code==3){jQuery("#error_msg").html("验证码不正确")}else{if(rs.code==4){jQuery("#error_msg").html("不属于这个用户的验证码")}else{if(rs.code==9){YHD.alert("前台提现需要先绑定手机");jQuery("#pop_win_ok_btn").click(function(){window.location.href=current_site_url+"/member/bind/bind.do"})}else{jQuery("#error_msg").html("系统异常，请稍后再试")}}}}}}function verifySubmitRefund(){jQuery("#bankCashAmount_font").html("*");
jQuery("#bankOwnerName_font").html("");jQuery("#bankCardNum_font").html("");jQuery("#bankName_font").html("*");jQuery("#city_font").html("");jQuery("#bankCardNum_br").hide();jQuery("#bankCardNum_label").hide();jQuery("#city_br").hide();jQuery("#city_label").hide();var a=jQuery("#availableAmount").val();var e=true;if(jQuery("#refundType").val()=="0"){var d=jQuery("#bankCashAmount").val();var f=jQuery("#bankOwnerName").val();var b=jQuery("#bankCardNum").val();var g=jQuery("#userInfo_address_provinceID").val();var c=jQuery("#bankName").val();var h=jQuery("#userInfo_address_cityID").val();if(!d){jQuery("#bankCashAmount_font").append("   X请填写提现金额");e=false}else{if(d.match("(^[0-9]{1,18}(\\.[0-9]{0,2})?$)")==null){jQuery("#bankCashAmount_font").append("   X最多精确到小数点后两位");e=false}else{if(d*1>a*1){jQuery("#bankCashAmount_font").append("   X提现金额不能大于"+a+"元");
e=false}}}if(!f||jQuery.trim(f).length==0){jQuery("#bankOwnerName_font").append("   X请填写持卡人姓名");e=false}else{if(jQuery.trim(f).length>30){jQuery("#bankOwnerName_font").append(" X请填写正确的银行账户名");e=false}}if(!b){jQuery("#bankCardNum_font").append("   X请填写银行卡号");e=false}else{if(b.match("(^[0-9]{6,40}$)")==null){jQuery("#bankCardNum_font").append("   X请填写正确的银行账户号，不超过40个字");jQuery("#bankCardNum_br").show();jQuery("#bankCardNum_label").show();e=false}}if(((!g)||g==0)||((g!=1&&g!=2&&g!=3&&g!=7)&&(!h||h==0))){jQuery("#city_font").append("   X请选择省份/城市");jQuery("#city_br").show();jQuery("#city_label").show();e=false}if((!c)||c==0){jQuery("#bankName_font").append("   X请选择银行名称");e=false}}else{e=false}return e}function submitRefund(){var b=verifySubmitRefund();if(!b){return}var a="/account/ajaxApplyRefund.do?";
if(jQuery("#refundType").val()=="0"){a=a+"applyAmount="+jQuery("#bankCashAmount").val();a=a+"&applyName="+encodeURI(encodeURI(jQuery("#bankOwnerName").val()));a=a+"&applyAccount="+jQuery("#bankCardNum").val();var c=jQuery("select[name='userInfo.address.cityID']").val();if(!c){c=""}a=a+"&applyBankName="+encodeURI(encodeURI(jQuery("#bankName").val()));a=a+"&provinceID="+jQuery("select[name='userInfo.address.provinceID']").val();a=a+"&cityID="+jQuery("select[name='userInfo.address.cityID']").val();a=a+"&bankName="+encodeURI(encodeURI(jQuery("#bankName").val()));a=a+"&applyType="+jQuery("#refundType").val()}if(jQuery("select[name='userInfo.address.provinceID']").val()==0||jQuery("select[name='userInfo.address.cityID']").val()==0){YHD.alert("请选择开户行！");return false}else{var d="请确认您输入的卡号为借记卡，并点击【确认】提交。";
if(window.confirm(d)){jQuery("#submitRefund_checkeDouble").attr("disabled",true);jQuery.post(a,null,submitResult)}}}function submitResult(a){if(a.code!=0){jQuery("#submitRefund_checkeDouble").removeAttr("disabled");if(a.code==-99){yhdLogin();return false}if(a.code==1){YHD.alert("您的申请失败了！")}if(a.code==3){YHD.alert("请输入正确的银行卡号")}}else{var b="";b+="<div class='tixian_box'>";b+="<h4>您的提现申请已提交</h4>";b+="<small>您申请的提现金额预计将在1~7个工作日内到账，请耐心等待。</small>";b+="<div class='tixian_box_center'>";b+="<p><label>收款账户类型：</label>银行账户</p>";b+="<p><label>需提现金额：</label><cite>￥</cite>"+jQuery("#bankCashAmount").val()+"</p>";b+="<p><label>持卡人姓名：</label>"+jQuery("#bankOwnerName").val()+"</p>";b+="<p><label>开户行：</label>"+jQuery("#bankName").val()+"</p>";b+="<p><label>银行卡号：</label>"+jQuery("#bankCardNum").val()+"</p>";
b+="<p><button type='submit' onclick='accountReload()'>确定</button></p>";b+="</div>";b+="</div>";if(jQuery("#refundType").val()=="0"){YHD.alert(b,accountReload)}jQuery("#pop_win_ok_btn").hide();jQuery(".aptab_center").attr("align","")}}function accountReload(){location.reload()}jQuery("#submitRefund").click(function(){var a="/account/ajaxApplyRefund.do?";if(jQuery("#refundType").val()=="0"){a=a+"applyAmount="+jQuery("#bankCashAmount").val();a=a+"&applyName="+jQuery("#bankOwnerName").val();a=a+"&applyAccount="+jQuery("#bankCardNum").val();a=a+"&applyBankName="+jQuery("#bankName").val();a=a+"&applyType="+jQuery("#refundType").val()}jQuery.post(a,null,submitResult)});jQuery(".popwinClose").click(function(){location.reload()});var RefundQueryUrl="/account/ajaxDisplayRefundInfo.do";var OrderQueryUrl="/account/ajaxDisplayOrderInfo.do";
jQuery(document).ready(function(){_loadMyYihaodianLeftMenu.loadLeftDiv();tabShow()});function viewRefundQueryList(a){jQuery.get(a,function(b){if(b.indexOf("notLogin")>=0){yhdLogin();return false}document.getElementById("refundInfoTable").innerHTML=b})}function viewOrderQueryList(a){jQuery.get(a,function(b){if(b.indexOf("notLogin")>=0){yhdLogin();return false}document.getElementById("refundInfoTable").innerHTML=b;loadUserUsedAccountType()})}function tabShow(){var a="#refundQuery";jQuery(".tabNav",a).children("span").click(function(){var b=jQuery(".tabNav",a).children("span").index(this);jQuery(this).addClass("cur").siblings().removeClass("cur");if(b==0){viewRefundQueryList(RefundQueryUrl)}else{viewOrderQueryList(OrderQueryUrl)}return false}).eq(0).trigger("click")}function loadAccountDisplayInfo(c){var e=$("#accountType").val();
var b=$("#accountStatus").val();var a=$("#amountDirection").val();var d="/account/ajaxDisplayOrderInfo.do?transactionType="+e+"&amountDirection="+a+"&pagenationVO.currentPage="+c;viewOrderQueryList(d)}function loadRefundInfo(a){var b=RefundQueryUrl+"?pagenationVO.currentPage="+a;viewRefundQueryList(b)}function loadUserUsedAccountType(){var d=jQuery("#accountType").val();var b=jQuery("#accountStatus").val();var a=jQuery("#amountDirection").val();var f=jQuery("#isDisplayAll").val();if(!f){f=""}var c="/account/query_account_type.do";var e={rd:Math.random(),transactionType:d,amountDirection:a,isDisplayAll:f};jQuery.get(c,e,function(g){jQuery("#accountType").html(g);jQuery("#accountType").change(function(){var h=jQuery(this).val();if(h==-2){loadUserAllAccountType("1")}})});jQuery("#accountType").change(function(){var i=$("#accountType").val();
var g=$("#amountDirection").val();var j=$("#isDisplayAll").val();if(!j){j=""}if(i!=-2){var h="/account/ajaxDisplayOrderInfo.do?transactionType="+i+"&amountDirection="+g+"&isDisplayAll="+j;viewOrderQueryList(h)}});jQuery("#accountStatus").change(function(){var i=$("#accountType").val();var h=$("#accountStatus").val();var g=$("#amountDirection").val();window.location="/account/displayAccount.do?transactionType="+i+"&amountDirection="+g});jQuery("#amountDirection").change(function(){var j=$("#accountType").val();var h=$("#accountStatus").val();var g=$("#amountDirection").val();var i="/account/ajaxDisplayOrderInfo.do?transactionType="+j+"&amountDirection="+g;viewOrderQueryList(i)})}function loadUserAllAccountType(f){var d=$("#accountType").val();var b=$("#accountStatus").val();var a=$("#amountDirection").val();
jQuery("#isDisplayAll").val(f);var c="/account/query_account_type.do";var e={rd:Math.random(),transactionType:d,amountDirection:a,isDisplayAll:f};jQuery.get(c,e,function(g){jQuery("#accountType").html(g);jQuery("#accountType").click()})};function yhdLogin(){yhdPublicLogin.showLoginDivNone(URLPrefix.passport,false,false,function(){location.reload()})};