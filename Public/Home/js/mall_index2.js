/* SVN.committedRevision=1560110 */
(function(){function b(a){this.option={container:null,content:null,trigger:null,pageButton:[],steps:1,effect:"visible",autoPlay:false,interval:3000,activeClass:"on",speed:300,eventType:"mouseover",delay:0};$.extend(this.option,a);this.index=0;this.timer=0;this.handlers={};this.box=$(this.option.container);if(this.box.length==0){return false}this.sprite=this.box.find(this.option.content);if(this.sprite.length==0){return false}this.trig=this.box.find(this.option.trigger).children();this.btnLast=this.box.find(this.option.pageButton[0]);this.btnNext=this.box.find(this.option.pageButton[1]);this.items=this.sprite.children();if(this.items.length==0){return false}this.total=this.items.length;if(this.total<=this.option.steps){return false}this.page=Math.ceil(this.total/this.option.steps);this.width=this.items.eq(0).outerWidth(true);
this.height=this.items.eq(0).outerHeight(true);this.init()}b.prototype={init:function(){this.initStyle();this.cutover(0);this.bindUI();this.autoPlay()},on:function(d,a){if(typeof this.handlers[d]=="undefined"){this.handlers[d]=[]}this.handlers[d].push(a);return this},fire:function(h,g){if(this.handlers[h] instanceof Array){var j=this.handlers[h];for(var i=0,a=j.length;i<a;i++){j[i](g)}}},initStyle:function(){var a=function(c){for(var d=0;d<c.option.steps;d++){c.items.eq(c.total-(d+1)).clone().prependTo(c.sprite);c.items.eq(d).clone().appendTo(c.sprite)}};switch(this.option.effect){case"scrollx":a(this);this.sprite.css({width:this.sprite.children().length*this.width,left:-this.option.steps*this.width});this.sprite.children().css("float","left");break;case"scrolly":a(this);this.sprite.css({top:-this.option.steps*this.height});
break;case"fade":this.items.css({position:"absolute",zIndex:0}).eq(this.index).css({zIndex:1});break;case"visible":this.items.css({display:"none"}).eq(this.index).css({display:"block"});break}var e=this;var f=setTimeout(function(){clearTimeout(f);e.fire("init")},30)},cutover:function(i){var h=(i==null)?this.option.speed:0;var g=this.index!=this.page?this.index:0;this.trig.eq(g).addClass(this.option.activeClass).siblings().removeClass(this.option.activeClass);switch(this.option.effect){case"visible":this.items.css({display:"none"}).eq(g).css({display:"block"});break;case"fade":this.items.css({position:"absolute",zIndex:0}).fadeOut(h);this.items.eq(g).css({zIndex:1}).fadeIn(h);break;case"scrollx":var a=this.width*this.option.steps;this.sprite.stop().animate({left:-a*this.index-a},h);break;case"scrolly":var j=this.height*this.option.steps;
this.sprite.stop().animate({top:-j*this.index-j},h);break}this.fire("cutover",g)},bindUI:function(){var d=this;var a=0;this.trig.bind(this.option.eventType,function(){var c=this;if(d.option.eventType=="mouseover"||d.option.eventType=="mouseenter"){if(d.index==$(c).index()){return}clearTimeout(a);a=setTimeout(function(){d.index=$(c).index();d.cutover();clearTimeout(a)},d.option.delay)}else{d.index=$(this).index();d.cutover()}});this.btnLast.click(function(){d.lastPage()});this.btnNext.click(function(){d.nextPage()});this.box.bind({mouseenter:function(){d.btnLast.show();d.btnNext.show();clearInterval(d.timer)},mouseleave:function(){d.btnLast.hide();d.btnNext.hide();d.autoPlay()}})},lastPage:function(){this.index--;if(this.index<-1){this.index=this.page-1;this.cutover(0);this.index=this.page-2
}this.cutover()},nextPage:function(){this.index++;if(this.index>this.page){this.index=0;this.cutover(0);this.index=1}this.cutover()},autoPlay:function(){var a=this;if(!this.option.autoPlay){return false}clearInterval(this.timer);this.timer=setInterval(function(){a.nextPage()},this.option.interval)}};window.Switchable=b})();var YHD=window.YHD||{};var MALL=YHD.MALL=YHD.MALL||{};YHD.MALL.hideProWin=function(){var o=(typeof indexHideProWinFlag!="undefined"&&indexHideProWinFlag=="1")?1:0;if(!o){return}var i=location.href;if(i.indexOf("forceId=")>0){var p=new RegExp("(\\?|&)forceId=([^&]*)(\\s|&|$)","i");if(p.test(i)){var k=RegExp.$1;var m=RegExp.$2;var n=RegExp.$3||"";if(k=="?"){i=i.replace(k+"forceId="+m+n,"?")}else{i=i.replace(k+"forceId="+m+n,n)}var j=i.length;if(i.charAt(j-1)=="?"||i.charAt(j-1)=="&"){i=i.substring(0,j-1)}if(history.replaceState){history.replaceState({},"",i)}else{var l=getCookie("provinceId");if(l){location.replace(i)}}}}};YHD.MALL.initDigitTab=function(){var g=$("#index_digit");if(g.size()==0){return}var h=function(){var a=new Date();return(a.getYear()+1900)+""+(a.getMonth()+1)+""+a.getDate()
};var f=$.trim(g.attr("data-url"));if(f){g.data("iframeLoaded","1");if(f.indexOf("?")==-1){f=f+"?randid="+h()}else{f=f+"&randid="+h()}var e="<iframe src='"+f+"' width='240' height='249' frameborder='0' scrolling='no'></iframe>";g.html(e)}};YHD.MALL.initAjaxReplaceAdvertise=function(){var n=$("#ajaxReplaceAdvCodesData");if(n.size()==0){return}var v=n.val();var z=(v&&v.length>0)?v.split(","):[];var t=(typeof currSiteId=="undefined")?1:currSiteId;var q=$.cookie("provinceId");var s="";var x=function(a,c){var f=null;var b=a[c];var g=b!=null?b:[];for(var d=0;d<g.length;d++){var e=g[d];if(e&&e.commonScreenImgUrl){f=e;break}}return f};var w=function(a,c){if(a.attr("data-done")=="1"){return}var d=c.tc;var b=c.tc_ext;if(d){a.attr("data-tc",d+".1");if(b){a.attr("data-tce",b)}}a.attr("href",c.landingPage).attr("title",c.text).attr("data-done","1").attr("data-ref",c.ref)
};var u=function(a,b){if(a.attr("data-done")=="1"){return}a.attr("alt",b.text).attr("src",b.commonScreenImgUrl).attr("data-done","1");if(a.attr("shortimg")!=null){a.attr("shortimg",loli.util.hashImgUrl(b.commonScreenImgUrl))}if(a.attr("wideimg")!=null){a.attr("wideimg",loli.util.hashImgUrl(b.commonScreenImgUrl))}if(a.attr("si")!=null){a.attr("si",loli.util.hashImgUrl(b.commonScreenImgUrl))}if(a.attr("wi")!=null){a.attr("wi",loli.util.hashImgUrl(b.commonScreenImgUrl))}if(a.attr("original")!=null){a.attr("original",loli.util.hashImgUrl(b.commonScreenImgUrl))}if(b.adBgColor){a.parents("li").attr("data-bgcolor",b.adBgColor)}};var o=function(){if(n.size()==0){return}var h=n.data("advsData");var g=n.data("doneAdvCodes")!=null?n.data("doneAdvCodes").split(","):[];if(h!=null){for(var b=0;b<z.length;
b++){var e=x(h,z[b]);var a=false;for(var c=0;c<g.length;c++){if(g[c]==z[b]){a=true;break}}if(!a&&e!=null){var f=$("body a[data-advId="+e.regionId+"]");var i=$("body img[data-advId="+e.regionId+"]");if(f.size()>0){for(var d=0;d<f.size();d++){w(f.eq(d),e);u(i.eq(d),e)}g.push(z[b]);n.data("doneAdvCodes",g.join(","))}}}}};var p=function(){var a=$("#chuchuangWrap,#mall_louceng_sf,#needLazyLoad,#mall_louceng_xf");a.find("a[data-ajax=1][data-nsf='1']").each(function(){var d=$(this).parent();var c=$(this);if(c.attr("data-nsf")=="1"&&c.attr("data-ajax")=="1"&&c.attr("data-done")!="1"){c.remove();if(d.attr("data-singlemodule")==1){d.remove()}else{if(d.hasClass("img_box")){var b=d.children().length;if(b==0){d.next(".trig_box").find("li>a").remove()}else{d.next(".trig_box").find("li>a:gt("+(b-1)+")").remove()
}}}}})};var r=function(b,c,e){var d="http://p4p.yhd.com/advdolphin/external/saleTypeWeightAd?callback=?";var a={mcSiteId:t,provinceId:q,codes:b,categoryIds:c,screenType:isWidescreen?"1":"2"};$.getJSON(d,a,function(h){if(h&&h.status==1){var g=h.value;if(g){var f=n.data("advsData");if(f==null){n.data("advsData",g)}else{f=$.extend(f,g);n.data("advsData",f)}o()}}if(e){p()}})};YHD.MALL.runAjaxReplaceAdvertise=o;YHD.MALL.delBlankAjaxAD=p;var y=function(){var b=false;var c=[];for(var a=0;a<z.length;a++){c.push(z[a]);if(a==z.length-1){b=true}if(c.length>=20){r(c.join(","),s,b);c=[]}}if(c.length>0){r(c.join(","),s,b)}};y()};YHD.MALL.initLunboAjaxReplaceAdvertise=function(){var m=$("#lunboAjaxReplaceAdvCodes");if(m.size()==0){return}var t=m.val();var x=(t&&t.length>0)?t.split(","):[];var r=(typeof currSiteId=="undefined")?1:currSiteId;
var o=$.cookie("provinceId");var q="";var v=function(b,d){var g=null;var c=b[d];var a=c!=null?c:[];for(var e=0;e<a.length;e++){var f=a[e];if(f&&f.commonScreenImgUrl){g=f;break}}return g};var u=function(b,d){if(b.attr("data-done")=="1"){return}var a=d.tc;var c=d.tc_ext;if(a){b.attr("data-tc",a+".1");if(c){b.attr("data-tce",c)}}b.attr("href",d.landingPage).attr("title",d.text).attr("data-done","1").attr("data-ref",d.ref)};var s=function(b,a){if(b.attr("data-done")=="1"){return}b.attr("alt",a.text).attr("src",a.commonScreenImgUrl).attr("data-done","1");if(b.attr("original")!=null){b.attr("original",loli.util.hashImgUrl(a.commonScreenImgUrl))}if(a.adBgColor){b.parents("li").attr("data-bgcolor",a.adBgColor)}};var n=function(){if(m.size()==0){return}var i=m.data("advsData");var h=m.data("doneAdvCodes")!=null?m.data("doneAdvCodes").split(","):[];
if(i!=null){for(var c=0;c<x.length;c++){var f=v(i,x[c]);var b=false;for(var d=0;d<h.length;d++){if(h[d]==x[c]){b=true;break}}if(!b&&f!=null){var g=$("body a[data-advId="+f.regionId+"]");var a=$("body img[data-advId="+f.regionId+"]");if(g.size()>0){for(var e=0;e<g.size();e++){u(g.eq(e),f);s(a.eq(e),f)}h.push(x[c]);m.data("doneAdvCodes",h.join(","))}}}}};var p=function(c,d){var a="http://p4p.yhd.com/advdolphin/external/saleTypeWeightAd?callback=?";var b={mcSiteId:r,provinceId:o,codes:c,categoryIds:d,screenType:$("#firstScreen").hasClass("big")?"1":"2"};$.getJSON(a,b,function(g){if(g&&g.status==1){var f=g.value;if(f){var e=m.data("advsData");if(e==null){m.data("advsData",f)}else{e=$.extend(e,f);m.data("advsData",e)}n()}}$("#promo_show").attr("data-ajax-done",1);YHD.MALL.adjustLunbo();YHD.MALL.initLunbo()
})};var w=function(){if(x.length>0){p(x.join(","),q)}else{YHD.MALL.initLunbo()}};w()};YHD.MALL.adjustLunbo=function(){var x=document.getElementById("index_menu_carousel");var s=function(a){var b=a.parentNode;if(b){b.removeChild(a)}};var x=document.getElementById("index_menu_carousel");if(x){if(x.getAttribute("data-adjust")=="1"){return}x.setAttribute("data-adjust",1);var u=[];var i=x.getElementsByTagName("li");for(var v=0;v<i.length;v++){var k=i[v];var o=k.getElementsByTagName("a").length>0?k.getElementsByTagName("a")[0]:null;if(o){if(o.getAttribute("data-nsf")=="1"&&o.getAttribute("data-ajax")=="1"&&o.getAttribute("data-done")!="1"){u.push(k)}}}if(u.length>0){for(var t=0;t<u.length;t++){var k=u[t];s(k);var w=lunboNum.getElementsByTagName("li");for(var r=0;r<w.length;r++){var p=w[r];if(p.getAttribute("flag")==k.getAttribute("flag")){s(p)
}}}i=x.getElementsByTagName("li");if(i.length>0){var q=i[0].getElementsByTagName("img").length>0?i[0].getElementsByTagName("img")[0]:null;if(q&&q.getAttribute("id")!="lunbo_1"){q.setAttribute("id","lunbo_1")}}}}};YHD.MALL.initLunbo=function(){var j=$("#promo_show");var f=$("#index_menu_carousel");var h=$("#lunboNum");if($("#index_menu_carousel>ol>li").size()==0){return}if(j.data("init-lunbo")==1){return}function g(){if(j.data("init-lunbo")==1){return}j.data("init-lunbo",1);$("#lunbo_1").load(function(){var c=window.global||(window.global={});var b=c.vars=(c.vars||{});c.vars.customInteractTime=c.vars.customInteractTime||new Date().getTime()});$("#index_menu_carousel img").each(function(){var b=$(this).attr("original");if(b){$(this).attr("src",b)}});$("#index_menu_carousel>ol>li").each(function(){$(this).css("backgroundColor",$(this).attr("data-bgcolor"))
});$("#index_menu_carousel>ol>li:eq(0)").show();var a=new Switchable({container:"#promo_show",content:".promo_wrapper ol",trigger:".mod_promonum_show ol",effect:"fade",activeClass:"cur",interval:5000,autoPlay:true,pageButton:[".show_pre",".show_next"]});a.on("cutover",function(b){var c=$("#index_menu_carousel>ol>li:eq("+b+")");i(c)})}function i(a){var c=$.cookie("provinceId");if(!c){c=0}if(c!=0){var b=a.find("a");var d=[];d.push(b);require(["base_observer"],function(e){e.fire("adContentTrackerEvent",d)})}if(typeof(extTracker)==="object"){extTracker.sendTrackByTrigger(a)}}if($("#lunboAjaxReplaceAdvCodes").size()>0&&j.attr("data-ajax-done")!="1"){setTimeout(function(){YHD.MALL.adjustLunbo();g()},2000)}else{YHD.MALL.adjustLunbo();g()}};YHD.MALL.getNowTime=function(){var d;if(typeof(nowTime)=="undefined"||nowTime==undefined){var c=new Date();
d=new Array(c.getFullYear(),c.getMonth()+1,c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds())}else{d=nowTime.split("-")}return new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5])};function getAjaxProductPrice(g,i){if(!jQuery.cookie("provinceId")&&!$(g)){return}var h=URLPrefix.busystock?URLPrefix.busystock:"http://gps.yhd.com";var j="?mcsite="+currBsSiteId+"&provinceId="+jQuery.cookie("provinceId");var k=$(g).find("[productid]");jQuery.each(k,function(c,a){var b=$(a).attr("productid");if(b!=null&&b!=""){j+="&productIds="+b}});var l=h+"/busystock/restful/truestock";jQuery.getJSON(l+j+"&callback=?",function(a){if(a==null||a==""){return}jQuery.each(a,function(d,b){var c=$(g).find("[productid='"+b.productId+"']");if(c){c.removeAttr("productid")}i(c,b)})})}YHD.MALL.initLimitBuy=function(){var i=$("#limitBuyWrap");
var f=currDomain+"/time/dynamictime";var h=function(){if(j){clearTimeout(j)}var b=YHD.MALL.getNowTime();var c=new Date(b.getFullYear(),b.getMonth(),b.getDate(),10,0,0);if(b.getHours()>=10){c=new Date(b.getFullYear(),b.getMonth(),b.getDate()+1,10,0,0)}var a=c.getTime()-b.getTime();var d=setInterval(function(){if(a<=0){$("span.h1",i).text("0");$("span.h2",i).text("0");$("span.m1",i).text("0");$("span.m2",i).text("0");$("span.b1",i).text("0");$("span.b2",i).text("0");clearInterval(d);return}var m=Math.floor(a/1000%60);var e=Math.floor(a/(1000*60)%60);var n=Math.floor(a/(1000*60*60)%60);$("span.h1",i).text(n>9?Math.floor(n/10):0);$("span.h2",i).text(n>9?n%10:n);$("span.m1",i).text(e>9?Math.floor(e/10):0);$("span.m2",i).text(e>9?e%10:e);$("span.b1",i).text(m>9?Math.floor(m/10):0);$("span.b2",i).text(m>9?m%10:m);
a-=1000},1000)};$.ajax({url:f,dataType:"script",complete:function(b,a){h()}});var j=setTimeout(function(){h()},500);var g=function(b,a){$("p.price",b).html("<strong>&yen;"+a.productPrice+"</strong><em>参考价：</em><s>&yen;"+a.marketPrice+"</s>");if(a.productStock<=0){$("p.finished",b).show()}};getAjaxProductPrice(i,g)};YHD.MALL.sliderIndexAd=function(c){function d(B){if(!B||B.size()==0){return}var v=B.find(".img_box");var s=B.find(".trig_box li");var u=v.children();var y=s.children();var b=u.length;var t=u.eq(0).width();var q=0;var A=0;var z=5000;if(b<=1){B.find(".trig_box").hide();return}B.find(".trig_box li a:gt(0) span").width(0);y.bind("mouseenter",function(){q=$(this).index();x();w()});B.bind({mouseenter:function(){clearInterval(A);w()},mouseleave:function(){r();a()}});function x(){v.stop().animate({left:-q*t});
y.removeClass("cur").eq(q).addClass("cur");a()}function r(){A=setInterval(function(){q++;if(q>b-1){q=0}x()},z);a()}function a(){var e=B.find(".trig_box li a.cur");B.find(".trig_box li a span").stop().css("width",0);e.find("span").width(0).animate({width:"30px"},z,function(){$(this).width(0)})}function w(){var e=B.find(".trig_box li a.cur");B.find(".trig_box li a span").stop().css("width",0);e.find("span").stop().width("100%")}r()}d(c)};YHD.MALL.initChuchuang=function(){var b=$("#chuchuangWrap");if(b.size()==0){return}b.lazyImg({indexLoad:true});YHD.MALL.sliderIndexAd(b.find("div.slider_index_ad"))};YHD.MALL.initFloor=function(){jQuery("#needLazyLoad").lazyDom({load:false,hfix:500,flushPrice:false,indexLoad:true,callback:function(){var d=$(this);YHD.MALL.runAjaxReplaceAdvertise();YHD.MALL.delBlankAjaxAD();
d.find("img").each(function(){var a=$(this).attr("original");if(a){$(this).attr("src",a).removeAttr("original")}});var c=d.find("div.slider_index_ad");YHD.MALL.sliderIndexAd(c)}})};YHD.MALL.backtop=function(){var d=$("#btnBackTop");c();$(window).scroll(function(){c()});function c(){if($(window).scrollTop()>100){d.show()}else{d.hide()}}d.click(function(){$("body,html").animate({scrollTop:0},300)})};jQuery(function(){YHD.MALL.hideProWin();YHD.MALL.initLunboAjaxReplaceAdvertise();YHD.MALL.initAjaxReplaceAdvertise();YHD.MALL.initLunbo();YHD.MALL.initLimitBuy();YHD.MALL.initChuchuang();jQuery("body").lazyImg({indexLoad:true,load:false});YHD.MALL.initFloor();YHD.MALL.initDigitTab();YHD.MALL.backtop()});