/* SVN.committedRevision=1560685 */
$(document).ready(function(){$(".grouProvince").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});if($("#grouponSearchEnable")&&$("#grouponSearchEnable").val()=="1"){$("#hd_search_tuan").show()}$("#hd_search_tuan").bind("click",function(){var c=$("#keyword").val();try{gotracker("2","YHD_GROUPON_GLOBAL_SEARCH"+c)}catch(a){}if(c==""||c=="请输入关键词"){$("#keyword").focus();return}else{var b="http://t.yhd.com/search?searchWord="+encodeURIComponent(c);location.href=b}});try{var g=$.cookie("grouponAreaId");if(g!=undefined&&g!=""){var h=$("#grouponPrvcBox").find("a[aid="+g+"]");if(h){var f=h.attr("title");if(f!=""){$("#grouponPrvcBox").find("li").attr("class","");$("#grouponProvince").html(f+"<span>[更换]</span>");h.parent().attr("class","cur")}}}}catch(e){}try{require(["content_tracker_expo"],function(a){a.run("adContentTrackerEvent","ad.dolphin.bidding")
})}catch(e){}});jQuery(document).ready(function(){lazyLoadImageObjArry=lazyLoadImageObjArry||[];lazyLoadImageObjArry.push("tuangouBody");initImageLoad();jQuery.YHD.imgLoad.load()});jQuery(document).ready(function(){YhdGroupon.common.backToTop();YhdGroupon.common.bannerSlide(".header_banner_left");YhdGroupon.common.bannerSlide(".footer_banner");YhdGroupon.common.someHover()});var YhdGroupon={};YhdGroupon.common={};YhdGroupon.common.province=function(){$("#grouponProvince").click(function(b){$("#grouponPrvcBox").show();$(this).addClass("cur");b.stopPropagation()});$("#grouponPrvcClose").click(function(){$("#grouponPrvcBox").hide();$("#grouponProvince").removeClass("cur")});$("body").click(function(){$("#grouponPrvcBox").hide();$("#grouponProvince").removeClass("cur")})};YhdGroupon.common.backToTop=function(){$(window).scroll(function(){if($(window).scrollTop()>210){$(".modFloatCate").show();if($.browser.msie==1&&$.browser.version==6){$(".modFloatCate").css("top",$(window).scrollTop()+$(window).height()-505)
}}else{$("#modFloatCate").hide()}});$(".toTop").click(function(){$("html, body").animate({scrollTop:0},400);return false})};YhdGroupon.common.someHover=function(){$("#modFloatCate li").hover(function(){$(this).addClass("hover").siblings().removeClass("hover")},function(){$(this).removeClass("hover")});$(".tab_brand").hover(function(){$(".pre, .next",this).show()},function(){$(".pre, .next",this).hide()});$("#tab_brand li").live("mouseover",function(){$(this).addClass("cur").siblings().removeClass("cur")});$("#tab_brand li").live("mouseout",function(){$(this).removeClass("cur")});$(".header_tab_top li").hover(function(){var b=$(".header_tab_top li").index($(this));$(this).addClass("cur").siblings().removeClass("cur");$(this).parent().siblings(".header_tab_con").eq(b).show().siblings(".header_tab_con").hide();
$(this).parent().siblings(".more_famous_brand").eq(b).show().siblings(".more_famous_brand").hide()})};YhdGroupon.common.bannerSlide=function(p){var m=1,q,n=$(p),r=n.find(".slideList"),j=r.find("li"),l=j.length,k=n.height(),o=n.find(".slideSwitch").find("li");o.first().addClass("cur");if(l<2){$(".slideSwitch",p).hide()}n.hover(function(){clearInterval(q)},function(){q=setInterval(function(){if(m==l){m=0}o.removeClass("cur").eq(m).addClass("cur");r.animate({marginTop:-k*(m++)},500)},5000)}).trigger("mouseout");o.mouseover(function(){var a=$(this).index();m=a+1;o.removeClass("cur");$(this).addClass("cur");r.stop().animate({marginTop:-k*a},500)})};function getCookie(j){var h=document.cookie;var g=h.split("; ");for(var i=0;i<g.length;i++){var f=g[i].split("=");if(f[0]==j){return f[1]}}return null
}function scrollNotice(h){var j,i=$("#"+h),f=i.find("ul");if(f.width()<=600){return}var g=f.clone().insertAfter(f);i.hover(function(){clearInterval(j)},function(){j=setInterval(function(){if(g[0].offsetWidth-i[0].scrollLeft<=0){i[0].scrollLeft-=f[0].offsetWidth}else{i[0].scrollLeft++}},30)}).trigger("mouseout")}YhdGroupon.common.conNavFloat=function(){var d=$("#conNav").offset();if(null==d||d==undefined){return}var c=$("#conNav").offset().top;$(window).scroll(function(){if($(window).scrollTop()>c){$("#conNav").addClass("fixed");if($.browser.msie==1&&$.browser.version==6){$("#conNav").css("top",$(window).scrollTop())}}else{$("#conNav").removeClass("fixed")}})};YhdGroupon.common.groupAreaChange=function(){var b=jQuery.cookie("grouponAreaId");if(b==grouponAreaId){return}jQuery.cookie("grouponAreaId",grouponAreaId,{domain:no3wUrl,path:"/",expires:800});
jQuery.cookie("grouponAreaId",grouponAreaId,{domain:URLPrefix.tuangou_YHD,path:"/",expires:800});$.ajax({url:"/tuangou/ajaxGetGrouponAreaConfig.do",data:{grouponAreaId:grouponAreaId},type:"POST",dataType:"json",success:function(a){$(a.data.grouponAreaConfig).each(function(){var d=jQuery.cookie("provinceId");if(d&&d!=this.provinceId){setAddressCity(this.provinceId)}jQuery.cookie("provinceId",this.provinceId,{domain:no3wUrl,path:"/",expires:800})})}})};function getQueryStringRegExp(d){var c=new RegExp("(^|\\?|&)"+d+"=([^&]*)(\\s|&|$)","i");if(c.test(location.href)){return unescape(RegExp.$2.replace(/\+/g," "))}return""}var globalUt;function showNewEmailSubscribe(){gotracker("2","YHD_GROUPON_EMAIL");var b="";b=getCookie("seus");if(b&&b!=null&&b!=""){globalUt=b}if(!globalUt||globalUt==null||globalUt==""){yhdPublicLogin.showLoginDivNone(URLPrefix.passport,false,"",function(a){if(a==0){yhdPublicLogin.showTopLoginInfo();
ininEmailSubscribe()}})}else{ininEmailSubscribe()}}function ininEmailSubscribe(){jQuery.ajax({type:"POST",url:"/tuangou/edmEditInYihaodianNew.do",async:false,success:function(b){if(b=="not_login"){yhdPublicLogin.showLoginDiv(window.location.href)}else{jQuery("#emailFeedPopwinId").show();jQuery("#emailFeedPopwinId").html(b);initEmailSubscribeJS()}}})}function closeEmailWindow(){jQuery("#emailFeedPopwinId").hide();jQuery(".pop_win_bg:first,#yhd_pop_win").hide()}function initEmailSubscribeJS(){$("#emailmodify").click(function(){$(this).hide();var b=$("#email_dress").text();$("#emailaddress").html("订阅邮箱：<input type='text' id='email_dress' class='email_input' value='"+b+"'/><span class='txt_tips'>请输入邮箱地址</span>")});$("#email_booked_modify").click(function(){$(this).hide();var b=$("#email_dress").text();
$("#emailaddress").html("订阅邮箱：<input type='text' id='email_dress' class='email_input' value='"+b+"'/><span class='txt_tips'>请输入邮箱地址</span>");$("#email_act").html("<a href='javascript:void(0);' onclick='closeEmailWindow()' class='e_cancel'>取消</a><a href='javascript:void(0);' class='e_submit' onclick='bookedEmailModifiedAjax()'>确定</a>")});jQuery("#emailFeedPopwinId").jqm({overlay:15,overlayClass:"pop_win_bg",modal:true,toTop:true}).jqmAddClose(".close").jqmShow()}function edmEmailSubscribe(){var d="";d=getCookie("seus");if(d&&d!=null&&d!=""){globalUt=d}if(!globalUt||globalUt==null||globalUt==""){closeEmailWindow();yhdPublicLogin.showLoginDivNone(URLPrefix.passport,false,"",function(a){if(a==0){yhdPublicLogin.showTopLoginInfo();ininEmailSubscribe()}})}else{var e=$("#email_dress").text();if(e==""){e=$("#email_dress").val()
}var f=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;if(!f.test(e)){$("#emailaddress").html("订阅邮箱：<input type='text' id='email_dress' class='email_input' value='"+e+"'/><span class='txt_tips_error'><i></i>您输入的邮箱格式不正确。</span>")}else{jQuery.ajax({type:"POST",url:"/tuangou/emailSubscribe.do",data:"emailAddress="+e,async:false,success:function(b){if(b.data=="000"){var a=$("#edmSendCouponControl").val();if(a=="1"){$("#emailContentInfo").html("<p class='email_txt'><strong>订阅成功！</strong></p><p class='email_txt'>团购邮件将发送至邮箱 ：<span id='email_dress' class='email_dress'>"+e+"</span></p><p class='email_txt'>订阅专享券已直接发放到您的账户，如需查看请至  <a href='"+URLPrefix.my+"/member/my.do' target='_blank' class='link'>个人中心</a><em class='splitline'>&gt;</em><a href='"+URLPrefix.central+"/myCoupon/index.do' target='_blank' class='link'>我的抵用券</a></p>")
}else{$("#emailContentInfo").html("<p class='email_txt'><strong>订阅成功！</strong></p><p class='email_txt'>团购邮件将发送至邮箱 ：<span id='email_dress' class='email_dress'>"+e+"</span></p>")}$("#email_act").html("<a href='javascript:void(0);' class='e_cancel' onclick='emailBookedTipEvent()'>我知道了</a>")}else{if(b.data=="001"){alert("调用edm订阅接口，传参错误！")}else{if(b.data=="002"){alert("用户已订阅该分类消息")}else{if(b.data=="not_login"){closeEmailWindow();yhdPublicLogin.showLoginDiv(window.location.href)}else{if(b.data=="email_format_error"){$("#emailaddress").html("订阅邮箱：<input type='text' id='email_dress' class='email_input' value='"+e+"'/><span class='txt_tips_error'><i></i>您输入的邮箱格式不正确。</span>")}}}}}}})}}}function emailBookedTipEvent(){var b=$("#email_dress").text();$("#emailContentInfo").html("<p class='email_txt'><strong>您已订阅团购邮件！</strong></p><p class='email_txt'>团购邮件将发送至邮箱 ：<span id='email_dress' class='email_dress'>"+b+"</span>如需退订或修改邮箱请至 <a href='"+URLPrefix.my+"/member/my.do' target='_blank' class='link'>个人中心</a><em class='splitline'>&gt;</em><a href='"+URLPrefix.my+"/member/userinfo/toChangeEmailPage.do' target='_blank' class='link'>修改邮箱</a></p>");
$("#email_act").html("<a href='javascript:void(0);' class='e_cancel' onclick='closeEmailWindow()'>我知道了</a>")}function bookedEmailModifiedAjax(){var d=$("#email_dress").val();var c=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;if(!c.test(d)){$("#emailaddress").html("订阅邮箱：<input type='text' id='email_dress' class='email_input' value='"+d+"'/><span class='txt_tips_error'><i></i>您输入的邮箱格式不正确。</span>")}else{jQuery.ajax({type:"POST",url:"/tuangou/bookedEmailModify.do",data:"emailAddress="+d,async:false,success:function(a){if(a.data=="000"){$("#emailContentInfo").html("<p class='email_txt'><strong>邮箱修改成功!</strong></p><p class='email_txt'>团购邮件将发送至邮箱 ：<span class='email_dress'>"+d+"</span><span class='lower'>3秒钟自动关闭。</span></p>");$("#email_act").html("<a href='javascript:void(0);' class='e_cancel' onclick='closeEmailWindow()'>我知道了</a>");
if(a.data=="000"){setTimeout(function(){closeEmailWindow()},3000)}}else{if(a.data=="001"){alert("调用edm修改邮箱接口，传参错误！")}else{if(a.data=="500"){alert("邮箱已绑定，请至个人中心页面修改")}else{if(a.data=="not_login"){closeEmailWindow();yhdPublicLogin.showLoginDiv(window.location.href)}else{if(a.data=="email_format_error"){$("#emailaddress").html("订阅邮箱：<input type='text' class='email_input' value='"+d+"'/><span class='txt_tips_error'><i></i>您输入的邮箱格式不正确。</span>")}}}}}}})}}function edmEmailUnsubscribe(){$("#emailContentInfo").html("<p class='email_txt'><strong>您确定要退订么？</strong></p><p class='email_txt'>还有很多惊喜来不及告诉你。</p>");$("#email_act").html("<a href='javascript:void(0);' onclick='closeEmailWindow()' class='e_cancel'>取消</a><a href='javascript:void(0);' class='e_submit' onclick='edmEmailUnsubscribeAjax()'>确定</a>")}function edmEmailUnsubscribeAjax(){jQuery.ajax({type:"POST",url:"/tuangou/edmEmailUnsubscribe.do",async:false,success:function(b){if(b.data=="000"){$("#emailContentInfo").html("<p class='email_txt'><strong>退订成功！</strong></p><p class='email_txt'>感谢您的陪伴！更多超值品牌，欢迎您常回来看看。</p>");
$("#email_act").html("<a href='javascript:void(0);' class='e_cancel' onclick='closeEmailWindow()'>我知道了</a>")}else{if(b.data=="001"){alert("调用edm团购邮件退订接口，传参错误！")}else{if(b.data=="400"){alert("该用户已经退订！")}else{if(b.data=="not_login"){closeEmailWindow();yhdPublicLogin.showLoginDiv(window.location.href)}}}}}})}function lazyLoadNoCommentProductInfo(){if(jQuery("#noCommentProductsView")[0]){if($.trim(jQuery("#noCommentProductsView").html())==""){jQuery("#noCommentProductsView").html("<p align='center'><img src='"+imagePath+"/loade.gif'/>请您稍等,数据正在加载...</p>");loadNoCommentProductInfo()}}}function loadNoCommentProductInfo(){jQuery.ajax({url:"/tuangou/exp/ajaxYhdMainPageView.do",success:function(b){if(b==""){document.getElementById("noCommentProductsView").innerHTML=""}else{document.getElementById("noCommentProductsView").innerHTML=b;
jQuery("#commentProductAmount").text(jQuery("#productAmount").val());window.scroll(0,0)}}})}function addTrackerEvent(){var d=document.getElementById("tuangouBody");var c=function(b){var i=getEvent(b);var e=getTarget(i);var a=$(e);var j=a.attr("tracker");if(j==undefined||j==null){j=a.parent().attr("tracker")}if(j){addTrackPositionToCookie("1",j)}};addEvent(d,"click",c)}function addEvent(d,e,f){if(!d){return false}if(d.addEventListener){d.addEventListener(e,f,false);return true}else{if(d.attachEvent){d.attachEvent("on"+e,function(){f.apply(d)});return true}}return false}function getEvent(b){return b||window.event}function getTarget(b){return b.target||b.srcElement}function stopPropagation(b){if(b.stopPropagation){b.stopPropagation()}else{b.cancelBubble=true}};var YhdBrandGroupon={};var currentTimeMillis=0;YhdBrandGroupon.homepage={};YhdBrandGroupon.homepage.log=function(a){alert(a)};var timeStatus=1;function getCurrentTimeMillis(){if(timeStatus==2&&currentTimeMillis>0){return currentTimeMillis}var b=URLPrefix.central+"/time/dynamictime";var a=new Date();jQuery.getScript(b,function(){if(nowTime!=undefined&&nowTime!=null){var c=nowTime.split("-");a=new Date(c[0],c[1],c[2],c[3],c[4],c[5])}});return a.getTime()}function isControlQianggou(){currentTimeMillis=getCurrentTimeMillis();if(timeStatus==1){timeStatus=2}if(zhengDianControlValue!=1){return false}if(zhengDianTimeRegion!=""){var d=new Date();d.setTime(currentTimeMillis);var a="";var b=d.getHours();var e=d.getMinutes();var c=d.getSeconds();if(b<10){a+="0"+b}else{a+=b}if(e<10){a+="0"+e}else{a+=e}if(c<10){a+="0"+c
}else{a+=c}for(i=0,len=zhengDianTimeRegion.length;i<len;i++){if(zhengDianTimeRegion[i].start<=a&&zhengDianTimeRegion[i].end>=a){return true}}}return false}YhdBrandGroupon.homepage.init=function(){try{if($(".autoBanner_mod li").length>1){yhdLib.switchable({container:".autoBanner_mod",content:".silde_box ul",trigger:".trig_box",activeClass:"cur",effect:"fade",pageButton:[".btn_prev",".btn_next"],autoPlay:false})}else{$(".button_box,.trig_box").hide()}}catch(b){}var a=$(".grouplist li[bid]");YhdBrandGroupon.homepage.countdownForBrandItems(a,getCurrentTimeMillis());YhdBrandGroupon.homepage.bindList(a);addTrackerEvent();jsListHoverFed.main();YhdGroupon.common.groupAreaChange();timeStatus=1;detailToLocation()};function detailToLocation(){var c=window.location.href;var b=c.indexOf("#");if(b>=0){var a=c.substring(b+1);
if(a!=""){scrollWindow(a)}}}YhdBrandGroupon.homepage.bindList=function(a){YhdBrandGroupon.homepage.addRedbord(a);YhdBrandGroupon.homepage.requestBrandStatus(a)};YhdBrandGroupon.homepage.countdownForBrandItems=function(a,b){a.each(function(){var g=$(this);var c=g.attr("bid");if(!c){return}var h=g.attr("startTime");var k=g.attr("endTime");var f=k-h;var d=0;var j="";var e=0;if(b<=h){f=h-b;e=1}else{if(k>=b){f=k-b;e=0}else{d=1}}if(d==1){}else{YhdBrandGroupon.homepage.countdownForBrand(g,e,f)}})};YhdBrandGroupon.homepage.countdownForBrand=function(j,e,g){var h=g/1000;if(h>=0){var f=Math.floor(h/(60*60*24));var d=Math.floor(h/(60*60))-(f*24);var b=Math.floor(h/60)-(f*24*60)-(d*60);var a=Math.floor(h)-(f*24*60*60)-(d*60*60)-(b*60);if(d>=0&&d<=9){d="0"+d}if(b>=0&&b<=9){b="0"+b}if(a>=0&&a<=9){a="0"+a
}msg=""+d+"时"+b+"分";if(f!=0){msg=""+f+"天"+msg}msg=msg+a+"秒";if(e=="1"){msg="<i></i>距离开始："+msg}else{msg="<i></i>剩余："+msg}if(f==0&&d==0&&b==0&&a==0){var c=j.find("div.listbox");c.removeClass("onsale").removeClass("readysale").removeClass("expire").addClass("onsale");c.find(".buybtn").find("a").html("立即购买").unbind("click");c.find(".buyshow").html("<i></i><strong></strong>立即购买")}else{j.find(".ctxt").html(msg);setTimeout(function(){YhdBrandGroupon.homepage.countdownForBrand(j,e,(--h)*1000)},1000)}}};YhdBrandGroupon.homepage.addRedbord=function(a){a.hover(function(){jQuery(this).addClass("cur")},function(){jQuery(this).removeClass("cur")})};jQuery(document).ready(function(){YhdBrandGroupon.homepage.init()});YhdBrandGroupon.homepage.requestBrandStatus=function(d){if(isControlQianggou()){return}var c="";
var b="";d.each(function(){b=$(this).attr("bid");if(b){c+="brandGrouponIDs="+b+"&"}});if(c.length>0){var a="/tuangou/ajaxGetBrandGrouponInfo.do?"+c+"callback=?";jQuery.getJSON(a,function(e){if(e.result==1){if(e.list){$(e.list).each(function(){var h;var f=this.brandGrouponID;d.each(function(){var k=$(this).attr("bid");if(k&&k==f){h=$(this);return false}});if(!h){return}var j=h.find("div.listbox");if(this.code==1){if(this.status==0){j.removeClass("onsale").removeClass("readysale").removeClass("expire").addClass("readysale");if(kttxFlag==1){j.find(".buyshow").html("<i></i><strong>"+this.reserveNum+"</strong>人已订阅");var g=jQuery.cookie("grouponAreaId");j.find(".buybtn").find("a").html("开团提醒").click(function(){Groupon.popReminderBrand(h.attr("bid"),g,0);return false})}else{j.find(".buyshow").html("<i></i><strong>"+this.reserveNum+"</strong>人已收藏");
j.find(".buybtn").find("a").html("即将开团")}}else{if(this.status==1){j.removeClass("onsale").removeClass("readysale").removeClass("expire").addClass("onsale");j.find(".buybtn").find("a").html("立即购买")}else{if(this.status==2){j.removeClass("onsale").removeClass("readysale").removeClass("expire").addClass("expire");j.find(".buybtn").find("a").html("已结束").click(function(){return false})}}}if(this.status!=0){j.find(".buyshow").html("<i></i><strong>"+this.saleNum+"</strong>人已购买")}j.find(".brand_discount").html("<em>"+this.discount+"</em><s>折起</s>");if(this.discount>=10){j.find(".brand_discount").html("<em></em><s></s>")}}})}}})}};YhdBrandGroupon.homepage.brandSlide=function(h){var g=3,f=1,b,e=$(".brand_ad_scroll"),a=e.find(".scroll_pic"),j=a.find("li"),c=h*g,d=e.find(".scroll_num li");d.first().addClass("cur");
e.hover(function(){clearInterval(b)},function(){b=setInterval(function(){if(f==g){f=1;j.eq(0).addClass("cur").css("top",c);a.animate({marginTop:-c},500,function(){j.eq(0).removeClass("cur").css("top",0);a.css("marginTop",0)})}else{var k=-h*f;a.animate({marginTop:k+"px"},500);f++}d.removeClass("cur");d.eq(f-1).addClass("cur")},5000)}).trigger("mouseout");d.mouseover(function(){var l=$(this).index(),k=-h*l;if(l!=0||f!=1){f=l+1;d.removeClass("cur");$(this).addClass("cur");a.stop().animate({marginTop:k},500)}})};YhdBrandGroupon.homepage.brandListExpand=function(){var b=$(".brGrouBrList li").length,a=Math.ceil(b/8)*81;if(b<9){$(".brBtnExpand").hide()}$(".brBtnExpand").click(function(){if(!$(this).hasClass("brBtnCollapse")&&b>8){$(this).parent().animate({height:81},200);$(this).siblings(".brGrouBrList").animate({height:81},200);
$(this).addClass("brBtnCollapse");$("em",this).text("展开")}else{$(this).parent().animate({height:a},200);$(this).siblings(".brGrouBrList").animate({height:a},200);$(this).removeClass("brBtnCollapse");$("em",this).text("收起")}});brandListHover();if($(".brGrouDetailHd").length>0){brandListShift();$(".brGrouBrList li:eq(0)").attr("id","brLiFirst")}};function brandListShift(){$(".brGrouBrList li").click(function(){var a=$(".brGrouBrList li").index($(this));$(".brGrouBrList li").eq(0).attr("id","").insertBefore($(".brGrouBrList li").eq(a));$(this).attr("id","brLiFirst").insertBefore($(".brGrouBrList li").eq(0));$(".brGrouBrList li").eq(0).addClass("cur").siblings().removeClass("cur");$(".brGrouBrList li").eq(0).find(".brGrouBrShow").show();$(".brGrouBrList li").eq(0).find(".brGrouBrMore").css({width:0,left:"50%"})
})}function brandListHover(){$(".brGrouBrList li").hover(function(){var a=$(".brGrouBrShow",this),b=$(".brGrouBrMore",this);$(this).addClass("cur");b.stop(true,true).animate({width:123,left:0},200);a.hide()},function(){var b=$(".brGrouBrShow",this),c=$(".brGrouBrMore",this),a=$(".brGrouBrList li").index($(this));if($(".brGrouDetailHd").length>0&&a!=0){$(this).removeClass("cur")}else{if($(".brGrouFullHd").length>0){$(this).removeClass("cur")}}c.stop(true,true).animate({width:0,left:"50%"},0);b.show()});$(".brGrouDetailHd .brGrouBrList").hover(function(){},function(){$("li",this).eq(0).addClass("cur")})};var jsListHoverFed={main:function(){this.tuanHover();this.moreBrand();this.brandDrop();this.sidebarFixed();this.brandSwitch();this.scrollFixed();this.scrollAct();this.weiboHover();this.listHover()},tuanHover:function(){$(".tuan_list li").hover(function(){$(this).find(".countime").show();$(this).find(".tuan_mask").addClass("current").find(".tuan_act a").stop().animate({opacity:1},500)},function(){$(this).find(".countime").hide();$(this).find(".tuan_mask").removeClass("current").find(".tuan_act a").stop().animate({opacity:0},500)})},weiboHover:function(){$(".modFloatCate li").hover(function(){$(this).addClass("hover").siblings().removeClass("hover");$(".hoverCon",this).show()},function(){$(this).removeClass("hover");$(".hoverCon",this).hide()})},moreBrand:function(){var a=$(".more_pp .tabs a");
a.click(function(){$(".more_pp .tabs a").removeClass("tab_cur");$(this).addClass("tab_cur");var b=$(this).index();$(".tab_cont").hide();$(".tab_cont").eq(b).show()})},brandDrop:function(){$(".tab_hl").hover(function(){$(this).find(".more_pp").show();$(this).find(".tab_h3 a").addClass("cur")},function(){var a=this;setTimeout(function(){$(a).find(".more_pp").hide();$(a).find(".tab_h3 a").removeClass("cur")},200)})},sidebarFixed:function(){var c=$("#sidebar");if(c.length<1){return false}var d=c.offset().top;var b=this;var a=navigator.appVersion.indexOf("MSIE 6")>-1;$(window).scroll(function(){var e=document.documentElement.scrollTop||document.body.scrollTop;if(e>d){a?c.css({position:"absolute",top:e-d+40}):c.css({position:"fixed",top:0})}else{c.css({position:"static",top:d})}})},scrollFixed:function(){var d=$("div[name='divFloor']");
var m=[];if(d){d.each(function(f){m.push("#"+this.id)})}var e=[];for(var g=0;g<m.length;g++){$(m[g]).length&&e.push($(m[g]).offset().top)}var h=0;var k=1;var l=112;var c=[$(".sidebar .logo")];var a=$(".sidebar .tag_list h3 .pull");a.each(function(f,i){c.push(i)});var j=$("input[name='logoHrefs']"),b=$("#logoImg");$(window).scroll(function(){var f=$(window).scrollTop()+50;if(h!=k){k=h;$(c).removeClass("cur").eq(h).addClass("cur");b.attr("src",j[h].value)}if(f>e[h]){h++}if(f<e[h-1]){h--}})},scrollAct:function(){$(window).scroll(function(){var a=$(window).scrollTop();if(a>202){$("#modFloatCate").show()}else{$("#modFloatCate").hide()}})},brandSwitch:function(){var a=12;$(".tab_cont").each(function(b,f){var d=0;var j=$(this).find(".pp_list li");var c=Math.ceil(j.length/a);var h=this;if(j.length<=a){$(h).find(".scro").hide()
}$(h).find(".scro_left").click(function(){if(d>0){d--;g()}});$(h).find(".scro_right").click(function(){if(d<c-1){d++;g()}});function g(){j.hide();for(var e=0;e<a;e++){var k=e+d*a;if(j.eq(k).length!=0){j.eq(k).show()}}}})},listHover:function(){var b=$(".grouplist");var a=b.find("li");a.each(function(){var d=$(this).find(".show_per");var c=$(this).find(".show_btn");$(this).hover(function(){var e=$(this).find(".listbox");$(this).addClass("hover");if(!e.hasClass("expire")){c.show();d.hide()}else{return false}},function(){$(this).removeClass("hover");if(!$(this).hasClass("expire")){c.hide();d.show()}else{return false}})})}};var yhdLib=yhdLib||{};yhdLib.switchable=function(e){var i={container:"",content:"",trigger:"",pageButton:[],steps:1,effect:"fade",autoPlay:false,interval:3000,activeClass:"on",speed:300,eventType:"mouseover",delay:0,init:null,onChange:null};var b=0;var k=0;var l={};var q,o,a,s,h,n,c,d;var g,m;l=$.extend(i,e);q=$(l.container);o=q.find(l.content);if(q.length<=0||o.length<=0){return false}a=o.children();s=a.length;h=Math.ceil(s/l.steps);n=q.find(l.trigger).children();c=q.find(l.pageButton[0]);d=q.find(l.pageButton[1]);if(l.init!=null){l.init()}j();p();f();function j(){g=a.eq(0).outerWidth();m=a.eq(0).outerHeight();switch(l.effect){default:case"scrollx":o.css({width:99999,position:"absolute"});a.css({"float":"left"});var t=g*l.steps;for(var u=0;u<l.steps;u++){$(a).eq(s-u-1).clone().prependTo(o);
o.css("left",-t)}break;case"scrolly":o.css({position:"absolute"});var v=m*l.steps;for(var u=0;u<l.steps;u++){$(a).eq(s-u-1).clone().prependTo(o);o.css("top",-v)}break;case"fade":a.css({opacity:0,"z-index":0,position:"absolute"});a.eq(0).css({opacity:1,"z-index":1});break;case"visible":a.css({display:"none"});a.eq(0).css({display:"block"});break}}function r(){if(l.onChange!=null){l.onChange(b,h)}n.eq(b).addClass(l.activeClass).siblings().removeClass(l.activeClass);switch(l.effect){default:case"scrollx":var t=g*l.steps;o.stop().animate({left:-t*b-t},l.speed);break;case"scrolly":var u=m*l.steps;o.stop().animate({top:-u*b-u},l.speed);break;case"fade":a.eq(b).stop().animate({opacity:1}).siblings().stop().animate({opacity:0});a.eq(b).css("z-index",1).siblings().css("z-index",0);break;case"visible":a.eq(b).css("display","block").siblings().css("display","none");
break}}function p(){var t=0;n.each(function(u,v){$(v).bind(l.eventType,function(){clearInterval(t);t=setInterval(function(){b=u;r();clearInterval(t)},l.delay)})});q.bind({mouseenter:function(){clearInterval(k)},mouseleave:function(){f()}});c.click(function(){b--;if(b==-2){b=h-2;if(l.effect=="scrollx"){o.css("left",-g*l.steps*h)}if(l.effect=="scrolly"){o.css("top",-m*l.steps*h)}}r()});d.click(function(){b++;if(b==h){b=0;if(l.effect=="scrollx"){o.css("left",0)}if(l.effect=="scrolly"){o.css("top",0)}}r()})}function f(){if(h<=1){return false}if(!l.autoPlay){return false}k=setInterval(function(){b++;if(b==h){b=0;o.css("left",0)}r()},l.interval)}};function scrollWindow(b){var a=$("#"+b).offset().top-20;$("body,html").animate({scrollTop:a},1000)}function getMoreTuanList(c,d,b,e){$("#"+c).append($("#"+d).val());jsListHoverFed.listHover();var a=$(".grouplist li[autoShow=0][fid="+e+"]");YhdBrandGroupon.homepage.bindList(a);YhdBrandGroupon.homepage.countdownForBrandItems(a,getCurrentTimeMillis());$("#showMore"+e).hide();$("#showLess"+e).show()}function shouSuoTuanList(b,c,a,d){$("#"+b+" li").each(function(e){if(e>=a*3){$(this).remove()}});$("#showLess"+d).hide();$("#showMore"+d).show()}function conNavFloat(c,e){(c==""||c==undefined)?c="#conNav":c;(e==""||e==undefined)?e="#thirdNavBack":e;var d=$(c).offset().top,f=$(e),b=c.replace(/\#/,""),a=b+"Fixed fixed";$(window).scroll(function(){if($(window).scrollTop()>d){$(c).addClass(a);f.show();if($.browser.msie==1&&$.browser.version==6){$(c).css("top",$(window).scrollTop())
}}else{f.hide();$(c).removeClass(a);if($.browser.msie==1&&$.browser.version==6){$(c).css("top",0)}}})};var timeArray;var grouponIds;var grouponAreaId;var globalUt;var isIndex=0;var map_load=0;var createReceiver=false;var updateReceiver=false;var submitBtnDisplay=false;var paymentSpecControl=false;var isValidCodeNeed=0;var VIRTUAL_TYPE_PRODUCT="0";var VIRTUAL_TYPE_SERVICE="1";String.prototype.mylength=function(){var c=this.match(/[\u00FF-\uFFFF]/gi);if(!c||c==null){return this.length}var d=this.length+c.length;return d};function redirectIfNotLogin(g){if(g){var j="/passport/login.do";var f="password";if(g.indexOf(j)!=-1&&g.indexOf(f)!=-1){window.location.replace("/passport/login_input.do");return false}var h="URL=/not_found.do";if(g.indexOf(h)!=-1){window.location.replace("/not_found.do");return false}var i="系统繁忙";if(g.indexOf(i)!=-1){window.location.replace("/tuangou/index.do");return false}}return true
}function checkServicePhone(){var b=jQuery("#tuan_mobile").val().trim();if(b==""||b==jQuery("#tuan_mobile").attr("promptValue").trim()){jQuery("#mobileError").html("手机号码为必填项，团购凭证将发送到此手机");jQuery("#mobileError").attr("class","error");return false}else{if(b!=""&&b!=jQuery("#tuan_mobile").attr("promptValue")){var c=/^\d{11}$/g;if(!b.match(c)){jQuery("#mobileError").html("手机号码格式不正确，请输入11位数字");jQuery("#mobileError").attr("class","error");return false}else{jQuery("#mobileError").html("");jQuery("#mobileError").attr("class","ok")}}else{jQuery("#mobileError").attr("class","error none")}}return true}function checkServiceConfirmPhone(){var c=jQuery("#tuan_mobile").val().trim();var a=jQuery("#mobileConfirm").val().trim();if(a==""||a==jQuery("#mobileConfirm").attr("promptValue").trim()){jQuery("#mobileConfirmError").html("请重新输入手机号，以保障团购凭证发送到您的手机");
jQuery("#mobileConfirmError").attr("class","error");return false}else{if(c==a){var b=/^\d{11}$/g;if(!a.match(b)){jQuery("#mobileConfirmError").html("手机号码格式不正确，请输入11位数字");jQuery("#mobileConfirmError").attr("class","error");return false}else{jQuery("#mobileConfirmError").html("");jQuery("#mobileConfirmError").attr("class","ok")}}else{jQuery("#mobileConfirmError").html("确认手机号码不一致");jQuery("#mobileConfirmError").attr("class","error");return false}}return true}function showWaitInfo(e,f){try{if(f==null){return}clearWaitInfo();jQuery(f).add('<span id="waitInfo">'+e+"</span>");if(jQuery("#waitInfo").size()>0){jQuery("#waitInfo").addClass("waitInfo")}}catch(d){}}function clearWaitInfo(){try{if($("#waitInfo").size()>0){$("#waitInfo").remove()}}catch(b){}}function GrouponBase(){}function setFreeRemined(j,g){var h=$("#reminderMobile").val();
var i='<div id="freeGroupremined"><small><s></s>1号团将根据你的设置，在开团前通过手机短信提醒您团购消息。</small><p><label for="">手机提醒：</label><input id="mobile" type="text" value='+h+'></p><p><label for="">验证码：</label><input id="validCode" type="text" value="" class="checkCode"/><img id="valid_code_pic" class="checkcodeImg" src="/tuangou/passport/valid_code.do"><span>看不清，<b class="checkCodeB">换一张</b></span></p><p><span class="bt">确 定</span></p></div>';function f(){refreshCode();$(".bt","#freeGroupremined").click(function(){submitMobile(j,g)});$(".checkcodeImg,.checkCodeB","#freeGroupremined").click(function(){refreshCode()})}yhdLib.popwin({poptitle:"设置免费开团提醒",popcontentstr:i});setTimeout(function(){f()},100)}function refreshCode(){var d=new Date();var c=document.getElementById("valid_code_pic");c.src="/tuangou/passport/valid_code.do?t="+d
}function submitMobile(f,j){var i=$("#mobile").val();var g=$("#validCode").val();if(i==null||i==""){alert("请输入手机号码");return}if(g==null||g==""){alert("请输入验证码");return}var h=/^1\d{10}$/;if(!h.test(i)){alert("手机号码格式不正确，请输入正确的手机号码");return}jQuery.ajax({async:false,type:"POST",url:"/tuangou/ajaxGrouponReminder.do",dataType:"json",data:{grouponId:f,areaId:j,mobile:i,validCode:g},success:function(b){if(b.message){var a=b.data;if(a==0){yhdLib.popclose();yhdLib.popwin({popcontentstr:'<div id="freeReminedOk"><small><s></s>操作成功！<br/>1号团将在开团前通过<a href="">免费短信</a>通知您</small></div>'});setTimeout(function(){yhdLib.popclose()},3000)}else{if(a==1){var c="";yhdPublicLogin.showLoginDiv(c);return}else{if(a==2){alert("验证码不正确");refreshCode();return}else{if(a==3){alert("手机格式不正确");return}else{if(a==4){alert("您已使用手机短信方式预约过该团购，不能重复预约");
return}else{if(a==5){alert("参数传输不正确，请稍后再试");return}else{if(a==6){alert("您预约的团购不存在");return}else{if(a==7){alert("团购开始前半小时短信提醒预约停止");return}}}}}}}}}}})}function buyCallBack(f,e){var d=redirectIfNotLogin(f);if(d){if(f&&f!="ok"){alert(f)}else{if(e==1){buySerialGroupon()}else{if($("#isLandingPage").val()==1){addGrouponCart()}else{window.location.href="/grouponBuy/"+$("#grouponId").val()}}}}}GrouponBase.prototype.agreePro=function(){window.location.href="/tuangou/grouponBuy.do"};GrouponBase.prototype.rejectPro=function(){window.location.href="/tuangou/index.do"};var Groupon=new GrouponBase();function changeGrouponArea(f){var e=window.location.href;var h=new RegExp("(^|\\?|&)(grouponAreaId)=([^&]*)","i");var g=h.exec(e);if(g){e=e.replace(h,"$1$2="+f)}else{if(e.indexOf("?")!=-1){e=e+"&grouponAreaId="+f
}else{e=e+"?grouponAreaId="+f}}window.location=e}jQuery(document).ready(function(){jQuery("#switch").hover(function(){jQuery("#switchcity").show()},function(){jQuery("#switchcity").hide()});jQuery("#categoryTag li").each(function(h){var i=window.location.href;var f=jQuery(this).find("a").attr("href");if(i.indexOf("todayStart=")>-1){if(f.indexOf("todayStart=")>-1){jQuery(this).addClass("current");return}}if(i.indexOf("categoryId=")>-1){if(f.indexOf("categoryId=")>-1){var j=i.charAt(i.indexOf("categoryId=")+11);var g=f.charAt(f.indexOf("categoryId=")+11);if(j==g){jQuery(this).addClass("current");return}}}if(i.indexOf("todayStart=")==-1&&i.indexOf("categoryId=")==-1){if(f.indexOf("todayStart=")==-1&&f.indexOf("categoryId=")==-1){jQuery(this).addClass("current");return}}});jQuery(".banner .less").toggle(function(){jQuery(this).addClass("up").html("收起");
jQuery(".banner img").eq(0).hide("slow");jQuery(".banner img").eq(1).show("slow")},function(){jQuery(this).removeClass("up").html("展开");jQuery(".banner img").eq(1).hide("slow");jQuery(".banner img").eq(0).show("slow")});jQuery(".msnqq").click(function(){jQuery("#share_address_link_top").val(window.location.href);jQuery("#share_address_top").toggle()});jQuery(".yj").click(function(){var l=jQuery("#grouponActivityName").text();var k=window.location.href;var h="发现一个超值的团购网站--1号团，我想您也会感兴趣！"+l+"查看详情："+k;var j="";var i="1号团今日团购";i=i.substring(0,95);var g=false;if(navigator.userAgent.toLowerCase().match(/chrome/)!=null||$.browser.msie){g=true}if(g){jQuery.ajax({async:true,type:"POST",url:"/tuangou/ajaxChangeGBK.do",dataType:"json",data:{mailSubject:i,mailBody:h},success:function(a){if(a!=null&&a.data!=null){h=a.data.mailBody;
i=a.data.mailSubject;j="mailto:"+j+"?subject="+i+"&body="+h;window.location=j}}})}else{j="mailto:"+j+"?subject="+encodeURI(i)+"&body="+encodeURI(h);window.location=j}});jQuery(".addList").click(function(){jQuery(this).addClass("current").siblings().removeClass("current");jQuery(this).find(".editSpan").show();jQuery(this).siblings().find(".editSpan").hide()});jQuery(".set").click(function(){jQuery(this).next(".setOk").show().animate({opacity:0},5000);return false});jQuery(".addList:gt(2)").hide();jQuery(".displyAllAddr").toggle(function(){jQuery(this).addClass("hideAllAddr").html("收起全部地址");jQuery(".addList:gt(2)").show()},function(){jQuery(this).removeClass("hideAllAddr").html("显示全部地址");jQuery(".addList:gt(2)").hide()});jQuery(".addrInputDiv input").focus(function(){$(this).css("color","#333")
});jQuery(".addrInputDiv input").blur(function(){if($(this).val().trim()==$(this).attr("promptValue").trim()){$(this).css("color","#ccc")}else{$(this).css("color","#666")}})});function afterNeedSmsCheck(e){var f=e.split(":");if(jQuery.trim(f[0])=="1"){alert("请先绑定手机");var d;if(currSiteType==1){d=URLPrefix.my}else{d=URLPrefix.mymall}window.location.href=d+"/member/bind/bind.do"}else{if(jQuery.trim(f[0])=="2"){initMobileUI(f[1])}else{if(jQuery.trim(f[0])=="0"){doSubmitSaveByAccount(f[0])}}}}function initMobileUI(b){YHD.popwin(jQuery("#payByAccountVerifyMobileUI").html(),"352px","220px");jQuery("#cellPhone").html(b);$(".label_right input").focus(function(){var a=$(".label_right input").val();if(a=="效验码是6位数字"){$(this).attr("value","")}$(this).css("color","#000");$(".errorMes").hide()});$(".label_right input").blur(function(){var d=$(".label_right input").val();
d=d.replace(/(^\s*)|(\s*$)/g,"");if(d.length==0){$(this).attr("value","效验码是6位数字").css("color","#ccc")}else{if("效验码是6位数字"!=d&&((d.length>0&&d.length!=6)||!d.match(/^\d+$/))){$(this).attr("value",d);showMobileValidError()}}var a=$(".label_right input").val();if(a==""||"效验码是6位数字"==a){$(this).attr("value","效验码是6位数字").css("color","#ccc")}else{$(this).attr("value",d).css("color","#000")}});doSendValidCodeToUserBindMobile()}function doSendValidCodeToUserBindMobile(){jQuery.post("/tuangou/SMSVali/SMSSendValidCodeToUserBindMobile.do",null,afterSendValidCodeToUserBindMobile)}function afterSendValidCodeToUserBindMobile(b){ret=b;if(ret=="success"){alert("效验码已成功发送到您的手机，请注意查收。");restartTimer()}else{if(ret=="too fast"){alert("请稍后!每次发送间隔不能小于一分钟。")}else{if(ret=="overflow times"){alert("您今天已验证5次，无法再验证。")}else{alert("服务器忙，请稍后再试")
}}}}function showMobileValidError(){jQuery("#mobileValidError").html("效验码有误，请重新输入！");jQuery("#mobileValidError").css("display","block")}function restartTimer(){$(".label_right a").replaceWith("<a><span>(<i id='verifyTime'>60</i>秒后可重新发送) </span></a>");timer("verifyTime")}function timer(d){var f=parseInt(document.getElementById(d).innerHTML)-1;var e=setInterval(function(){document.getElementById(d).innerHTML=f;f--;if(f==-1){clearInterval(e);$(".label_right a").replaceWith("<a href='javascript:void(0);' onClick='doSendValidCodeToUserBindMobile();'><span>重新发送效验码</span></a>")}},1000)}function changeInvoiceHead(){var c=jQuery("#invoiceHeadType option:selected").val();var d=jQuery("#curReceiverName").val();if(c=="1"){jQuery("#invoiceCompyName").val(d)}else{jQuery("#invoiceCompyName").val("单位名称")}}function confirmCheckInvoice(c){var d=jQuery("#needInvoice").attr("checked");
if(c==1&&d==false){jQuery("#needInvoice").attr("checked",true);alert("您购买的产品需强制开发票！");return false}return true}function clickNormalHead(f){var g=jQuery("#invoiceHeadType option:selected").val();var h=jQuery("#curReceiverName").val();var a=jQuery(f).val();if(g=="1"){if(a==h){jQuery(f).val("")}}else{if(a=="单位名称"){jQuery(f).val("")}}}function restoreInvoiceHead(f){var g=jQuery("#invoiceHeadType option:selected").val();var h=jQuery("#curReceiverName").val();var a=jQuery(f).val();if(g=="1"){if(!a){jQuery(f).val(h)}}else{if(!a){jQuery(f).val("单位名称")}}}function cShowHide(e,d,f){$(e).click(function(){if(f==0){$(d).show();return false}else{$(d).hide();return false}})}var merchant="000";var isWidescreen;var currSiteId;function backToTop(){$(window).scroll(function(){if($(window).scrollTop()>0){$(".backToTop").show();
if($.browser.msie==1&&$.browser.version==6){$(".backToTop").css("top",$(window).scrollTop()+$(window).height()-90)}}else{$(".backToTop").hide()}})}function loadBackLandingPage(){if(backLandingPage==1&&$("#isLandingPage").val()==1){if(serialProductId!=null&&serialProductId!=0){productId=serialProductId}addGrouponCart()}}GrouponBase.prototype.popReminder=function(f,i,g){var h="";h=getCookie("seus");if(h&&h!=null&&h!=""){globalUt=h}var j="";if(!checkInReminderTime(f)){return}if(!globalUt||globalUt==null||globalUt==""){yhdPublicLogin.showLoginDivNone(URLPrefix.passportmall,true,"",function(a){if(a==0){yhdPublicLogin.showTopLoginInfo();if(g==0||g==2){if(!checkReminderByAppBeforePop(j,f,1)){return}popKttxDialog(f,i)}else{if(g==1){if(!checkReminder(j,f,1)){return}setFreeRemined(f,i)}}}})}else{if(g==0||g==2){if(!checkReminderByAppBeforePop(j,f,1)){return
}popKttxDialog(f,i)}else{if(g==1){if(!checkReminder(j,f,1)){return}setFreeRemined(f,i)}}}};function popKttxDialog(j,g){popmeun(".mod_popup_setting",".awakebtn_groupon");$("#errorTip").html("<span></span>");$("#errorTip").css("display","none");var i=$("#reminderMobile").val();$("#mobileNew").val(i);if(i==""||i==null||i==undefined){$("#validCodeZone").css("display","block")}else{var f=$("#mobileNew").val();if(f!=i){$("#validCodeZone").css("display","block")}else{$("#validCodeZone").css("display","none")}$("#mobileNew").keyup(function(){var a=$("#mobileNew").val();if(a!=i){$("#validCodeZone").css("display","block")}else{$("#validCodeZone").css("display","none")}})}$("#msgCheckbox").attr("checked",true);$("#appCheckbox").attr("checked",true);$("#validCodeNew").val("");function h(){refreshCodeNew();
$("#mobileNew").attr("disabled","");$("#mobileNew").focus();$(".btn_yes",".mod_popup_setting").unbind("click").click(function(){submitKttxDialog(j,g)})}setTimeout(function(){h()},100)}var popmeun=function(l,g){var k=$(l);var i=($.browser&&$.browser.msie&&parseInt($.browser.version,10)==6)||(window.ActiveXObject&&!window.XMLHttpRequest);var j=$("#mask");function h(){var a=$(".jsclose");a.bind("click",function(){k.hide();j.hide()})}h();$(window).scroll(function(){var a=$(window).scrollTop();if(i){k.css({top:a})}});var g=$(g);k.show();j.show()};function msgInputDialogStatusChange(){if($("#msgCheckbox").attr("checked")){$("#mobileNew").attr("disabled","");$("#mobileNew").focus();var c=$("#reminderMobile").val();if(c==""||c==null||c==undefined){$("#validCodeZone").css("display","block")}else{var d=$("#mobileNew").val();
if(d!=c){$("#validCodeZone").css("display","block")}else{$("#validCodeZone").css("display","none")}}}else{$("#mobileNew").attr("disabled","disabled");$("#validCodeZone").css("display","none")}}function refreshCodeNew(){var d=new Date();var c=document.getElementById("valid_code_pic_new");c.src="/tuangou/passport/valid_code.do?t="+d;$("#validCodeNew").val("");$("#validCodeNew").focus()}function submitKttxDialog(k,j){$("#errorTip").html("<span></span>");$("#errorTip").css("display","none");$("#noReminderDialog").css("display","none");if(!$("#appCheckbox").attr("checked")&&!$("#msgCheckbox").attr("checked")){$("#errorTip").html("<span>请选择开团提醒的推送方式：手机短信 或 1号店app！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);return}var n=0;var o=1;
var r=$("#mobileNew").val();if($("#msgCheckbox").attr("checked")){if(r==null||r==""){$("#errorTip").html("<span>请输入手机号码！</span>");$("#errorTip").css("display","block");$("#mobileNew").attr("disabled","");$("#mobileNew").focus();setTimeout(function(){$("#errorTip").css("display","none")},3000);return}var q=/^1\d{10}$/;if(!q.test(r)){$("#errorTip").html("<span>手机号码格式不正确，请输入正确的手机号码！</span>");$("#errorTip").css("display","block");$("#mobileNew").attr("disabled","");$("#mobileNew").focus();setTimeout(function(){$("#errorTip").css("display","none")},3000);return}n=1;var l="";if(!checkReminderNew(l,k,1)){$("#msgCheckbox").attr("checked",false);$("#mobileNew").attr("disabled","disabled");$("#validCodeZone").css("display","none");return}}else{n=0}var p=$("#validCodeNew").val();if($("#validCodeZone").css("display")=="block"){if(p==null||p==""){$("#errorTip").html("<span>请输入验证码！</span>");
$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);return}}else{p="noNeedValidCode"}if($("#appCheckbox").attr("checked")){o=1;var m="";if(!checkReminderByAppAfterPop(m,k,1)){$("#appCheckbox").attr("checked",false);return}}else{o=0}jQuery.ajax({async:false,type:"POST",url:"/tuangou/ajaxGrouponReminderNew.do",dataType:"json",data:{grouponId:k,areaId:j,mobile:r,msgCheckbox:n,appCheckbox:o,validCode:p},success:function(b){if(b.message){var a=b.data;if(a==0){$(".mod_popup_setting").hide();$("#mask").hide();yhdLib.popclose();yhdLib.popwin({popcontentstr:'<div id="freeReminedOk"><small><s></s>操作成功！<br/>1号团将在开团前通过<a href="">免费短信或1号店app</a>通知您</small></div>'});setTimeout(function(){yhdLib.popclose()},3000)}else{if(a==1){var c="";yhdPublicLogin.showLoginDiv(c);
return}else{if(a==2){$("#errorTip").html("<span>验证码输入有误，请重新输入！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);refreshCodeNew();return}else{if(a==3){$("#errorTip").html("<span>手机格式不正确！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);return}else{if(a==4){alert("您已使用手机短信方式预约过该团购，不能重复预约");return}else{if(a==5){alert("参数传输不正确，请稍后再试");return}else{if(a==6){alert("您预约的团购不存在");return}else{if(a==7){alert("团购开始前半小时短信提醒预约停止");return}else{if(a==8){alert("您已使用app推送方式预约过该团购，不能重复预约");return}else{if(a==20){$(".mod_popup_setting").hide();$("#mask").hide();$("#reminderTipDialog").css("display","block");$("#tipContent").html("<i></i><span>请稍后再预约！</br><em>您在过去的24小时内订阅次数已达到20次</em></span>");
setTimeout(function(){$("#reminderTipDialog").css("display","none");$("#tipContent").html("<i></i><span></br><em></em></span>")},3000);return}}}}}}}}}}}}})}function checkInReminderTime(c){var d=false;jQuery.ajax({async:false,type:"POST",url:"/tuangou/ajaxCheckInRemindTime.do",dataType:"json",data:{grouponId:c},success:function(a){if(a.message){var b=a.data;if(b==0){d=true}else{$("#reminderTipDialog").css("display","block");$("#tipContent").html("<i></i><span>不可预约！</br><em>此团购马上开始，预约时间已过，请谅解!</em></span>");setTimeout(function(){$("#reminderTipDialog").css("display","none");$("#tipContent").html("<i></i><span></br><em></em></span>")},3000);d=false}}}});return d}function checkReminder(e,f,g){var h=false;jQuery.ajax({async:false,type:"POST",url:"/tuangou/ajaxCheckReminder.do",dataType:"json",data:{grouponId:f,type:g},success:function(a){if(a.message){var b=a.data;
if(b==0){h=true;if(a.message!="success"){$("#reminderMobile").val(a.message)}}else{if(b==1){yhdPublicLogin.showLoginDiv(e);h=false}else{if(b==4){alert("您已使用手机短信方式预约过该团购，不能重复预约");h=false}else{if(b==5){alert("参数传输不正确,请稍后再试");h=false}else{alert("网络连接问题,请稍后再试");h=false}}}}}}});return h}function checkReminderNew(e,f,g){var h=false;jQuery.ajax({async:false,type:"POST",url:"/tuangou/ajaxCheckReminder.do",dataType:"json",data:{grouponId:f,type:g},success:function(a){if(a.message){var b=a.data;if(b==0){h=true;if(a.message!="success"){$("#reminderMobile").val(a.message)}}else{if(b==1){yhdPublicLogin.showLoginDiv(e);h=false}else{if(b==4){$("#errorTip").html("<span>您已使用手机短信方式预约过该团购，不能重复预约！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);h=false
}else{if(b==5){alert("参数传输不正确,请稍后再试");h=false}else{alert("网络连接问题,请稍后再试");h=false}}}}}}});return h}function checkReminderByAppBeforePop(e,f,g){var h=false;jQuery.ajax({async:false,type:"POST",url:"/tuangou/ajaxCheckReminderByAppBeforePop.do",dataType:"json",data:{grouponId:f,type:g},success:function(a){if(a.message){var b=a.data;if(b==0){h=true;if(a.message!="success"){$("#reminderMobile").val(a.message)}}else{if(b==1){yhdPublicLogin.showLoginDiv(e);h=false}else{if(b==4){h=true;if(a.message!="success"){$("#reminderMobile").val(a.message)}}else{if(b==5){alert("参数传输不正确,请稍后再试");h=false}else{if(b==6){h=true;if(a.message!="success"){$("#reminderMobile").val(a.message)}}else{if(b==7){$("#reminderTipDialog").css("display","block");$("#tipContent").html("<i></i><span>不能重复预约！</br><em>您已使用短信推送方式和app推送方式预约过该团购</em></span>");
setTimeout(function(){$("#reminderTipDialog").css("display","none");$("#tipContent").html("<i></i><span></br><em></em></span>")},3000);h=false}else{alert("网络连接问题,请稍后再试");h=false}}}}}}}}});return h}function checkReminderByAppAfterPop(e,f,g){var h=false;jQuery.ajax({async:false,type:"POST",url:"/tuangou/ajaxCheckReminderByAppAfterPop.do",dataType:"json",data:{grouponId:f,type:g},success:function(a){if(a.message){var b=a.data;if(b==0){h=true}else{if(b==1){yhdPublicLogin.showLoginDiv(e);h=false}else{if(b==4){$("#errorTip").html("<span>您已使用app推送方式预约过该团购，不能重复预约！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);h=false}else{if(b==5){alert("参数传输不正确,请稍后再试");h=false}else{alert("网络连接问题,请稍后再试");h=false}}}}}}});return h}function closeNoReminderDialog(){$("#reminderTipDialog").css("display","none");
$("#tipContent").html("<i></i><span></br><em></em></span>")};GrouponBase.prototype.popReminderBrand=function(i,h,j){var f="";f=getCookie("seus");if(f&&f!=null&&f!=""){globalUt=f}var g="";if(!checkInReminderTimeBrand(i)){return}if(!globalUt||globalUt==null||globalUt==""){yhdPublicLogin.showLoginDivNone(URLPrefix.passportmall,true,"",function(a){if(a==0){yhdPublicLogin.showTopLoginInfo();if(j==0||j==2){if(!checkReminderByAppBeforePop(g,i,2)){return}popKttxDialogBrand(i,h)}else{if(j==1){if(!checkReminder(g,i,2)){return}setFreeReminedBrand(i)}}}})}else{if(j==0||j==2){if(!checkReminderByAppBeforePop(g,i,2)){return}popKttxDialogBrand(i,h)}else{if(j==1){if(!checkReminder(g,i,2)){return}setFreeReminedBrand(i)}}}};function checkInReminderTimeBrand(d,e){var f=false;jQuery.ajax({async:false,type:"POST",url:"/tuangou/ajaxCheckInRemindTimeBrand.do",dataType:"json",data:{brandId:d},success:function(a){if(a.message){var b=a.data;
if(b==0){f=true}else{$("#reminderTipDialog").css("display","block");$("#tipContent").html("<i></i><span>不可预约！</br><em>此品牌团马上开始，预约时间已过，请谅解!</em></span>");setTimeout(function(){$("#reminderTipDialog").css("display","none");$("#tipContent").html("<i></i><span></br><em></em></span>")},3000);f=false}}}});return f}function popKttxDialogBrand(g,i){$("#errorTip").html("<span></span>");$("#errorTip").css("display","none");popmeunBrand(".mod_popup_setting",".awakebtn_brand");var f=$("#reminderMobile").val();$("#mobileNew").val(f);if(f==""||f==null||f==undefined){$("#validCodeZone").css("display","block")}else{var h=$("#mobileNew").val();if(h!=f){$("#validCodeZone").css("display","block")}else{$("#validCodeZone").css("display","none")}$("#mobileNew").keyup(function(){var a=$("#mobileNew").val();if(a!=f){$("#validCodeZone").css("display","block")
}else{$("#validCodeZone").css("display","none")}})}$("#msgCheckbox").attr("checked",true);$("#appCheckbox").attr("checked",true);$("#validCodeNew").val("");function j(){refreshCodeNew();$("#mobileNew").attr("disabled","");$("#mobileNew").focus();$(".btn_yes",".mod_popup_setting").unbind("click").click(function(){submitKttxDialogBrand(g,i)})}setTimeout(function(){j()},100)}var popmeunBrand=function(h,i){var g=$(h);var k=($.browser&&$.browser.msie&&parseInt($.browser.version,10)==6)||(window.ActiveXObject&&!window.XMLHttpRequest);var l=$("#mask");function j(){var a=$(".jsclose");a.bind("click",function(){g.hide();l.hide()})}j();$(window).scroll(function(){var a=$(window).scrollTop();if(k){g.css({top:a})}});var i=$(i);g.show();l.show()};function submitKttxDialogBrand(l,o){$("#errorTip").html("<span></span>");
$("#errorTip").css("display","none");$("#noReminderDialog").css("display","none");if(!$("#appCheckbox").attr("checked")&&!$("#msgCheckbox").attr("checked")){$("#errorTip").html("<span>请选择开团提醒的推送方式：手机短信 或 1号店app！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);return}var r=0;var s=1;var m=$("#mobileNew").val();if($("#msgCheckbox").attr("checked")){r=1;var p="";if(!checkReminderNew(p,l,2)){$("#msgCheckbox").attr("checked",false);$("#mobileNew").attr("disabled","disabled");$("#validCodeZone").css("display","none");return}if(m==null||m==""){$("#errorTip").html("<span>请输入手机号码！</span>");$("#errorTip").css("display","block");$("#mobileNew").attr("disabled","");$("#mobileNew").focus();setTimeout(function(){$("#errorTip").css("display","none")
},3000);return}var k=/^1\d{10}$/;if(!k.test(m)){$("#errorTip").html("<span>手机号码格式不正确，请输入正确的手机号码！</span>");$("#errorTip").css("display","block");$("#mobileNew").attr("disabled","");$("#mobileNew").focus();setTimeout(function(){$("#errorTip").css("display","none")},3000);return}}else{r=0}var t=$("#validCodeNew").val();if($("#validCodeZone").css("display")=="block"){if(t==null||t==""){$("#errorTip").html("<span>请输入验证码！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);return}}else{t="noNeedValidCode"}if($("#appCheckbox").attr("checked")){s=1;var q="";if(!checkReminderByAppAfterPop(q,l,2)){$("#appCheckbox").attr("checked",false);return}}else{s=0}var n="/tuangou/ajaxBrandSmsSubscribeNew.do?grouponId="+l+"&mobile="+m+"&validCode="+t+"&msgCheckbox="+r+"&appCheckbox="+s+"&isTuangouPage=1&type=2";
jQuery.getJSON(n,function(c){if(!c){return}if(c.result){var b=c.result;if(b==0){$(".mod_popup_setting").hide();$("#mask").hide();yhdLib.popclose();yhdLib.popwin({popcontentstr:'<div id="freeReminedOk"><small><s></s>操作成功！<br/>1号团将在开团前通过<a href="">免费短信或1号店app</a>通知您</small></div>'});setTimeout(function(){yhdLib.popclose()},3000)}else{if(b==15){var a="";yhdPublicLogin.showLoginDiv(a);return}else{if(b==2){$("#errorTip").html("<span>验证码输入有误，请重新输入！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);refreshCodeNew();return}else{if(b==3){$("#errorTip").html("<span>手机格式不正确！</span>");$("#errorTip").css("display","block");setTimeout(function(){$("#errorTip").css("display","none")},3000);return}else{if(b==4){alert("您已使用手机短信方式预约过该品牌团，不能重复预约");
return}else{if(b==5){alert("参数传输不正确，请稍后再试");return}else{if(b==6){alert("您预约的品牌团不存在");return}else{if(b==7){alert("品牌团开始前半小时短信提醒预约停止");return}else{if(b==8){alert("您已使用app推送方式预约过该品牌团，不能重复预约");return}else{if(b==20){$(".mod_popup_setting").hide();$("#mask").hide();$("#reminderTipDialog").css("display","block");$("#tipContent").html("<i></i><span>请稍后再预约！</br><em>您在过去的24小时内订阅次数已达到20次</em></span>");setTimeout(function(){$("#reminderTipDialog").css("display","none");$("#tipContent").html("<i></i><span></br><em></em></span>")},3000);return}}}}}}}}}}}})}function setFreeReminedBrand(g){var e="";var f='<div id="freeGroupremined"><small><s></s>1号团将根据你的设置，在开团前通过手机短信提醒您团购消息。</small><p><label for="">手机提醒：</label><input id="mobile" type="text" value='+e+'></p><p><label for="">验证码：</label><input id="validCode" type="text" value="" class="checkCode"/><img id="valid_code_pic" class="checkcodeImg" src="/tuangou/passport/valid_code.do"><span>看不清，<b class="checkCodeB">换一张</b></span></p><p><span class="bt">确 定</span></p></div>';
function h(){refreshCode();$(".bt","#freeGroupremined").click(function(){submitMobileBrand(g)});$(".checkcodeImg,.checkCodeB","#freeGroupremined").click(function(){refreshCode()})}yhdLib.popwin({poptitle:"设置免费开团提醒",popcontentstr:f});setTimeout(function(){h()},200)}function submitMobileBrand(g){var j=$("#mobile").val();var h=$("#validCode").val();if(j==null||j==""){alert("请输入手机号码");return}if(h==null||h==""){alert("请输入验证码");return}var i=/^1\d{10}$/;if(!i.test(j)){alert("手机号码格式不正确，请输入正确的手机号码");return}var f="/tuangou/ajaxBrandSmsSubscribe.do?grouponId="+g+"&mobile="+j+"&validCode="+h+"&isTuangouPage=1&type=2";jQuery.getJSON(f,function(c){if(!c){return}if(c.result){var b=c.result;if(b==0){yhdLib.popclose();yhdLib.popwin({popcontentstr:'<div id="freeReminedOk"><small><s></s>操作成功！<br/>1号团将在开团前通过<a href="">免费短信或1号店app</a>通知您</small></div>'});
setTimeout(function(){yhdLib.popclose()},3000)}else{if(b==15){var a="";yhdPublicLogin.showLoginDiv(a);return}else{if(b==2){alert("验证码不正确");refreshCode();return}else{if(b==3){alert("手机格式不正确");return}else{if(b==4){alert("您已使用手机短信方式预约过该团购，不能重复预约");return}else{if(b==5){alert("参数传输不正确，请稍后再试");return}else{if(b==6){alert("您预约的品牌团不存在");return}else{if(b==7){alert("品牌团开始前半小时短信提醒预约停止");return}}}}}}}}}})};jQuery(document).ready(function(){changeLinkUrlForIndex()});function changeLinkUrlForIndex(){var a=jQuery.cookie("grouponAreaId");if(a!=undefined&&a==31){$("#logo_areaID a:first").attr("href","http://www.yhd.com/?from=other");$("#global_menu a").each(function(b,c){if($(this).html()=="首页"){$(this).attr("href","http://www.yhd.com/?from=other");return}})}};function searchMe1(){$("#keyword").unbind("keydown").bind("keydown",function(b){if(b.keyCode==13){var a=$("#keyword").val();if(a==""){alert("请输入搜索关键字");$("#keyword").focus();return}addTrackPositionToCookie("1","YHD_GROUPON_INDEXTOP_SEARCH");loli.spm.openPage($("#hd_search_tuan"),"/search?searchWord="+a)}})}$(document).ready(function(){searchMe1()});